/*!
  @title com.philips.Sonos.ModuleLib.js
  @version 1.8
  @author Philips
*/
// Timestamp : 200912090605

/*
 * Copyright (c) 2009 Koninklijke Philips Electronics N.V.
 * ALL RIGHTS RESERVED.
 * Reproduction in whole or in part is prohibited without the written
 * consent of the copyright owner.
 *
 * This source code and any compilation or derivative thereof is the
 * proprietary information of Koninklijke Philips Electronics N.V.
 *
 * Under no circumstances is this software to be combined with any Open
 * Source Software in any way or licensed under any Open License Terms
 * without the express written permission of Koninklijke Philips
 * Electronics N.V.
 *
 * For the purpose of this clause, the term Open Source Software means
 * any software that is licensed under Open License Terms. Open License
 * Terms means terms in any license that require as a condition of use,
 * modification and/or distribution of a work
 *
 *     1. the making available of source code or other materials
 *        preferred for modification, or
 *     2. the granting of permission for creating derivative works, or
 *     3. the reproduction of certain notices or license terms in
 *        derivative works or accompanying documentation, or
 *     4. the granting of a royalty-free license to any party under
 *        Intellectual Property Rights regarding the work and/or any
 *        work that contains, is combined with, requires or otherwise
 *        is based on the work.
 */
var build = {};
build.timestamp = "200912090605";
build.version = "1.8";
/*
  %full_name: leu07hc1#1/ascii/com.philips.Util.js/8 %
  %created_by: ycl %
  %version: 8 %
  %date_created: Wed Dec  9 17:47:25 2009 %
*/
var com;if(!com){com={};}else{if(typeof com!=="object"){throw new Error("com already exists and is not an object");}}if(!com.philips){com.philips={};}else{if(typeof com.philips!=="object"){throw new Error("com.philips already exists and is not an object");}}if(com.philips.Util){throw new Error("com.philips.Util already exists");}com.philips.Util={};((function(){var j,k,g=/[\x80-\xFF]/,i=false;function a(n){var l,m;if(!n){return;}l=n.toString().split(/[\n\r\f]/);for(m in l){if(System&&System.print){System.print(l[m]);}else{if(print){print(l[m]);}}}}function f(m,q){var n,p,o,l;if(i){n="TRACE: "+m+"(";if(q.length>0){p=[];for(o=0;o<q.length;o+=1){l=q[o];if(typeof l==="string"){p.push("'"+l+"'");}else{p.push(l);}}p.concat(q);n+=p.join(",");}n+=")";a(n);}}function c(l){i=(l)?true:false;}function h(l){var n;if(!l){return;}if(!k){k=/^<\?xml\s+version\s*=\s*(["'])[^\1]+\1[^?]*\?>/;}try{n=l.replace(/\0/g,"");n=n.replace(k,"");return new XML(n);}catch(m){throw m;}}function d(){var m=100,u=null,p=false,n=true;function t(){if(n){p=false;}else{if(u){try{u();}catch(v){a("Error in callback: "+v);n=true;}if((n===false)&&(u)&&(m>0)){Activity.scheduleAfter(m,t);p=true;}else{p=false;}}}}function r(){if((n===false)&&(u)&&(m>0)&&(p===false)){Activity.scheduleAfter(m,t);p=true;}}function l(){n=false;r();}function s(){n=true;}function q(v){m=parseInt(v,10);r();}function o(v){u=v;r();}this.start=l;this.stop=s;this.setInterval=q;this.setCallback=o;}function b(){var n;function l(){var q,p,o;if(n.length>0){q=n.shift();p=(new Date()).getTime();try{q.func();}catch(r){a("Error: "+r);}o=(new Date()).getTime();}}function m(p){var q,o;o=(new Date()).getTime();q={func:p,queueDate:o};n.push(q);}n=[];this.add=m;this.schedule=l;}function e(p){var l,q,n,o,m;g.lastIndex=0;o=p.search(g);if(o<0){return p;}l="";q=0;n=0;for(;o>=0;o=p.substr(n).search(g)){l+=p.substr(q,o);n+=o;m=p.charCodeAt(n);if((m>=192)&&(m<224)){m=((m&31)<<6)|(p.charCodeAt(n+1)&63);n+=2;}else{if(m<240){m=((m&15)<<12)|((p.charCodeAt(n+1)&63)<<6)|(p.charCodeAt(n+2)&63);n+=3;}else{if(m<248){m=((m&7)<<18)|((p.charCodeAt(n+1)&63)<<12)|((p.charCodeAt(n+2)&63)<<6)|(p.charCodeAt(n+3)&63);n+=4;}else{throw new Error("Invalid UTF-8 sequence");}}}if(m<65536){l+=String.fromCharCode(m);}else{l+=String.fromCharCode((m>>10)|55296)+String.fromCharCode((m&1023)|56320);}q=n;}l+=p.substring(q);return l;}j=com.philips.Util;j.printLine=a;j.trace=f;j.textToXML=h;j.decodeUTF8=e;j.PeriodicTimer=d;j.BatchQueue=b;j.__defineSetter__("tracing",c);}()));/*
  %full_name: leu07hc1#1/ascii/colors.js/2 %
  %created_by: ycl %
  %version: 2 %
  %date_created: Tue Dec  8 11:26:42 2009 %
*/
var COLORS;COLORS={aqua:16776960,black:0,blue:16711680,fuchsia:16711935,gray:8421504,green:32768,lime:65280,maroon:128,navy:8388608,olive:32896,orange:42495,purple:8388736,red:255,silver:12632256,teal:8421376,white:16777215,yellow:65535,LightSkyBlue:16436871,MediumSlateBlue:15624315,MidnightBlue:7346457,RoyalBlue:14772545};/*
  %full_name: leu07hc1#1/ascii/Math.uuid.js/1 %
  %created_by: ycl %
  %version: 1 %
  %date_created: Tue Dec  8 14:04:10 2009 %

  The following Math.uuid implementation is based on
  Math.uuid.js (v1.4), http://www.broofa.com/

  For this portion, the following notice applies:

Copyright (c) 2009 Robert Kieffer

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
Math.uuid=(function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return function(b,e){var c,g,f=a,d=[];e=e||f.length;if(b){for(c=0;c<b;c+=1){d[c]=f[0|Math.random()*e];}}else{d[8]=d[13]=d[18]=d[23]="-";d[14]="4";for(c=0;c<36;c+=1){if(!d[c]){g=0|Math.random()*16;d[c]=f[(c===19)?(g&3)|8:g];}}}return d.join("");};}());/*
  %full_name: leu07hc1#1/ascii/com.philips.KBD.js/5 %
  %created_by: ycl %
  %version: 5 %
  %date_created: Wed Dec  9 17:47:22 2009 %
*/
var com;if(!com){com={};}else{if(typeof com!=="object"){throw new Error("com already exists and is not an object");}}if(!com.philips){com.philips={};}else{if(typeof com.philips!=="object"){throw new Error("com.philips already exists and is not an object");}}if(com.philips.KBD){throw new Error("com.philips.KBD already exists");}com.philips.KBD={};(function(){var a;function b(){var E,v,Q,H,A,f,B,s,D=0,w=0,m=0,R=COLORS.black,o=COLORS.silver,z=COLORS.white,N=COLORS.gray,K=COLORS.black,q=15790320,l=COLORS.black,x=COLORS.orange,i=COLORS.LightSkyBlue,e=COLORS.navy,t;t=[[["a","b","c","d","e","f","g","h","i","j"],["k","l","m","n","o","p","q","r","s","t"],["u","v","w","x","y","z","/","\\",":","."],["1","2","3","4","5","6","7","8","9","0"]],[["A","B","C","D","E","F","G","H","I","J"],["K","L","M","N","O","P","Q","R","S","T"],["U","V","W","X","Y","Z","/","\\",":","."],["1","2","3","4","5","6","7","8","9","0"]],[["!","@","#","$","%","^","&","*","?","+"],["/","\\",":",";","~","-","_","'",'"',"="],[".",",","(",")","[","]","<",">"]]];function r(W,V,U,X,T){var S;S=GUI.addPanel();S.left=W;S.top=V;S.width=U;S.height=X;S.visible=true;if(T){S.bgcolor=T;}return S;}function P(X,W,V,Y,T,U){var S;S=GUI.addButton();S.left=X;S.top=W;S.width=V;S.height=Y;S.transparent=false;S.visible=true;if(T){S.setColor(0,0);S.setColor(0,1);S.setBgColor(T,0);S.setBgColor(T,1);}if(U){S.onPress=U;}return S;}function G(U,S,T){U.setColor(S,0);U.setColor(S,1);U.setBgColor(T,0);U.setBgColor(T,1);}function F(V,T){var S,U;U=t[m][V];if(U!==undefined){S=U[T];}return S;}function h(){var T,X,U,V,S,W;switch(m){case 0:G(Q,z,N);G(H,R,o);G(A,R,o);break;case 1:G(Q,R,o);G(H,z,N);G(A,R,o);break;case 2:G(Q,R,o);G(H,R,o);G(A,z,N);break;default:break;}if(D!==4){W=F(D,w);if(W===undefined){D=0;w=0;}}for(X=0;X<4;X=X+1){V=f[X];S=t[m][X];for(T=0;T<10;T=T+1){U=V[T];if(S){W=S[T];}else{W=undefined;}if(W){if((D===X)&&(w===T)){G(U,l,x);}else{G(U,K,q);}U.label=W;U.visible=true;}else{U.visible=false;}}}}function p(V,U){var S,T;if(V===4){switch(U){case 0:return B;case 1:return s;}}T=f[V];S=T[U];return S;}function k(U,T){var S;S=p(D,w);G(S,K,q);D=U;w=T;S=p(D,w);S=G(S,l,x);}function c(T,S,V){var U;if(T.row!==undefined){U=t[m][T.row][T.col];v.label+=U;k(T.row,T.col);}else{}}function C(){v.label+=" ";k(4,0);}function J(){v.label=v.label.slice(0,-1);k(4,1);}function y(S,T){this.that.KeyPress(this,S,T);}function j(S,T){this.that.Space();}function g(S,T){this.that.BackSpace();}function I(U,T){var S;switch(GUI.width){case 640:S=P(20+(61*U),80+80+8+(T*56),50,50,16777215,y);S.fontSize=20;break;case 240:S=P(7+(23*U),50+80+3+(T*21),19,19,16777215,y);S.fontSize=15;break;}S.that=E;S.row=T;S.col=U;return S;}function n(S){var T;if(S!==undefined){T=S;}else{T=m+1;}if(T>2){T=0;}if(T!==m){m=T;h();}}function u(){var S;if(D===4){switch(w){case 0:this.Space();return;case 1:this.BackSpace();return;}}S=p(D,w);this.KeyPress(S);}function d(){var S,T;S=D;T=w+1;if((S>4)||((S===4)&&(T>1))){T=0;S=0;}else{if(T>9){T=0;S=S+1;}if(S<4){if(F(S,T)===undefined){T=0;S=4;}}}k(S,T);}function O(){var S,T;S=D;T=w-1;if(T<0){S=S-1;if(S===-1){S=4;T=1;}else{if(S>=t[m].length){S=t[m].length-1;}T=t[m][S].length-1;}}k(S,T);}function M(){var T,S,U;switch(GUI.width){case 640:T=r(20,116,640-40,40,i);T.fontSize=22;break;case 240:T=r(7,60,240-15,20,i);T.fontSize=12;break;}T.color=e;T.label="";v=T;f=[];for(U=0;U<4;U=U+1){f[U]=[];for(S=0;S<10;S=S+1){f[U][S]=I(S,U);}}switch(GUI.width){case 640:T=P(447,480-84,172,50,q);T.fontSize=20;break;case 240:T=P(167,320-80,65,28,q);T.fontSize=10;break;}T.label="Backspace";T.that=E;T.onPress=g;s=T;switch(GUI.width){case 640:T=P(263,480-84,172,50,q);T.fontSize=20;break;case 240:T=P(99,320-80,65,28,q);T.fontSize=10;break;}T.label="Space";T.that=E;T.onPress=j;B=T;switch(GUI.width){case 640:T=P(10,480-60,64,20,N);T.fontSize=13;break;case 240:T=P(4,320-40,35,13,N);T.fontSize=6;break;}T.setColor(z,0);T.setColor(z,1);T.label="Lower";T.that=E;T.onPress=function(){this.that.Shift(0);};Q=T;switch(GUI.width){case 640:T=P(10+60+10,480-60,64,20,o);T.fontSize=13;break;case 240:T=P(4+40+4,320-40,35,13,N);T.fontSize=6;break;}T.setColor(R,0);T.setColor(R,1);T.label="Caps";T.that=E;T.onPress=function(){this.that.Shift(1);};H=T;switch(GUI.width){case 640:T=P(10+60+10+60+10,480-60,64,20,o);T.fontSize=13;break;case 240:T=P(4+40+4+40+4,320-40,35,13,N);T.fontSize=6;break;}T.setColor(R,0);T.setColor(R,1);T.label="Symbols";T.that=E;T.onPress=function(){this.that.Shift(2);};A=T;h();}function L(){return v.label;}E=this;this.init=M;this.Shift=n;this.KeyPress=c;this.Space=C;this.BackSpace=J;this.NextKey=d;this.PrevKey=O;this.OK=u;this.__defineGetter__("value",L);}a=com.philips.KBD;a.KeyBoard=b;}());/*
  %full_name: leu07hc1#1/ascii/com.philips.Widgets.js/19 %
  %created_by: ycl %
  %version: 19 %
  %date_created: Wed Dec  9 17:47:26 2009 %
*/
var com;if(!com){com={};}else{if(typeof com!=="object"){throw new Error("com already exists and is not an object");}}if(!com.philips){com.philips={};}else{if(typeof com.philips!=="object"){throw new Error("com.philips already exists and is not an object");}}if(com.philips.Widgets){throw new Error("com.philips.Widgets already exists");}com.philips.Widgets={};(function(){var b,c=this;function a(){var F,t,J,n,w,B,H,d,C,v,N=30,G=20,p=7;this.onBack=null;this.onItem=null;this.onSelect=null;function E(O,Q,P){O.setColor(Q,0);O.setColor(Q,1);O.setBgColor(P,0);O.setBgColor(P,1);}function L(){}function h(){var O;if(v.menu.length>0){O=Math.floor(v.offset*((p*N)-6)/v.menu.length);B.top=150+3+O;}}function z(){var P,O;for(P=0;P<p;P=P+1){O=F[P];if(v){if((v.menu)&&(v.menu.length>0)&&((P+v.offset)<v.menu.length)){O.label=" "+v.menu[P+v.offset].title;E(O,COLORS.navy,COLORS.LightSkyBlue);O.visible=true;}else{O.visible=false;}}}if((v)&&(v.menu)){d.visible=(v.menu.length===0);}else{d.visible=false;}}function s(Q){var O,P;if((v.selectedRowButton!==undefined)&&(v.selectedRowButton!==-1)){O=F[v.selectedRowButton];O.fontSize=G;E(O,COLORS.navy,COLORS.LightSkyBlue);}if(Q<0){return;}v.selectedRowButton=Q;O=F[Q];O.fontSize=G+2;E(O,COLORS.navy,COLORS.white);O=w;if(v){P=v.menu[v.selectedRowButton+v.offset];if((P)&&(C.onSelect)){C.onSelect(P);}if((P)&&(P.menu)){O.top=150+(Q*N);O.visible=true;}else{O.visible=false;}}else{O.visible=false;}}function f(Q){var P,O;if((!v.offset)||(!Q)){v.offset=0;}z();if(Q){s(v.selectedRowButton);}else{s(0);}if((v)&&(v.menu)&&(v.menu.length>p)){h();H.visible=true;B.visible=true;B.height=(p*((p*N)-6))/v.menu.length;}else{B.visible=false;H.visible=false;}}function l(){var O;if(v.selectedRowButton!==undefined){O=v.menu[v.selectedRowButton+v.offset];}return O;}function k(){var O;O=l();if((O)&&(C.onItem)){C.onItem(O);}}function A(P){var O,Q=P||1;if(v.menu.length<0){return;}O=v.selectedRowButton-Math.round(Q);if(O<0){v.offset+=O;if(v.offset<0){v.offset=0;}O=0;z();h();}s(O);}function o(P){var O,Q=P||1;if(v.menu.length<0){return;}O=v.selectedRowButton+Math.round(Q);if(O>=(v.menu.length-v.offset)){O=v.menu.length-v.offset-1;}if(O>=p){v.offset+=(O+1-p);O=p-1;z();h();}s(O);}function y(O){if(O.onBack){O.onBack();}}function r(Q,O,R){var P;if(v.selectedRowButton===Q.rowIndex){k();}else{s(Q.rowIndex);}}function u(O,P){this.that.listBoxRowPress(this,O,P);}function I(){var P,O;F=[];for(P=0;P<p;P=P+1){O=GUI.addButton();O.left=8;O.top=150+(P*N);O.width=640-8-8-32;O.height=N;O.fontSize=G;O.halign="left";O.valign="center";O.that=C;O.rowIndex=P;O.onPress=u;F[P]=O;}O=GUI.addButton();O.left=640-8-32-32;O.top=150;O.width=32;O.height=N;O.fontSize=G;O.label="\uF097";E(O,COLORS.red,COLORS.white);w=O;O=GUI.addButton();O.left=640-32;O.top=150;O.height=(p*N);O.width=16+8;E(O,COLORS.navy,COLORS.navy);H=O;O=GUI.addButton();O.left=640-32+3;O.top=150+3;O.height=(p*N)-6;O.width=16+8-6;E(O,COLORS.navy,COLORS.gray);B=O;O=GUI.addPanel();O.left=32;O.width=GUI.width-64;O.top=200;O.height=50;O.halign="center";O.valign="center";O.fontSize=20;O.label="No selections are available.";O.transparent=true;d=O;}function q(O,P){v=O;f(P);}function D(O){switch(O.tag){case"PS_CURSOR_UP":t=1;A();break;case"PS_CURSOR_DOWN":t=1;o();break;case"PS_OK":case"PS_CURSOR_RIGHT":k();break;case"PS_CURSOR_LEFT":y(O.that);break;default:break;}}function x(O){var P;switch(O.tag){case"PS_CURSOR_UP":t*=1.3;A(Math.round(t));break;case"PS_CURSOR_DOWN":t*=1.3;o(Math.round(t));break;default:break;}}function M(O){J*=1.3;if(O===0){J=1;}else{if(O<0){if(n>0){J=1;}A((O<4)?-(O*J)/2:1);}else{if(O>0){if(n<0){J=1;}o((O>4)?(O*J)/2:1);}}}n=O;}function e(O,P){this.that.hardKeyPress(this);}function i(O,P){this.that.hardKeyHold(this);}function K(O){this.rotaryListBox.rotaryMotion(O);}function j(){var O;O=CF.activity();t=1;J=1;n=0;O.rotarySound=false;O.onRotary=K;O.rotaryListBox=C;["PS_OK","PS_CURSOR_UP","PS_CURSOR_DOWN","PS_CURSOR_RIGHT","PS_CURSOR_LEFT"].forEach(function(Q){var P;P=GUI.widget(Q);P.onPress=e;P.that=C;});["PS_CURSOR_UP","PS_CURSOR_DOWN"].forEach(function(Q){var P;P=GUI.widget(Q);P.onHold=i;P.onHoldInterval=100;});}function g(){["PS_OK","PS_CURSOR_UP","PS_CURSOR_DOWN","PS_CURSOR_RIGHT","PS_CURSOR_LEFT"].forEach(function(P){var O;O=GUI.widget(P);O.onPress=null;O.onHold=null;});CF.activity().onRotary=null;}function m(O){d.label=O;}this.init=I;this.setItems=q;this.up=A;this.down=o;this.getCurrentItem=l;this.listBoxRowPress=r;this.hardKeyPress=D;this.hardKeyHold=x;this.rotaryMotion=M;this.attachCursorPad=j;this.detachCursorPad=g;this.__defineSetter__("emptyLabel",m);C=this;L();}b=com.philips.Widgets;b.ListBox=a;}());/*
  @title com.philips.HttpLibrary
  @version 1.4
  @author Philips
 */
/*
 * %created_by: ycl %
 * %version: 2 %
 * %date_created: Tue Jun 30 14:22:51 2009 %
 */
var com;if(!com){com={};}else{if(typeof com!=="object"){throw new Error("com already exists and is not an object");}}if(!com.philips){com.philips={};}else{if(typeof com.philips!=="object"){throw new Error("com.philips already exists and is not an object");}}if(com.philips.HttpLibrary){throw new Error("com.philips.HttpLibrary already exists");}com.philips.HttpLibrary={};((function(){var k=false,y,q=-1,v,z,f,A,s,o,n,i,r,C;f=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;A=/^([^:]*):?(.*)/;s=/^([A-Z\/\.0-9]*) ([0-9]*) (.*)/;o=/([^()<>@,;:\\"\/\[\]?={}\s]*)\/([^()<>@,;:\\"\/\[\]?={}\s]*)\s*(;.*)?/;n=/\s*(\S+)=(\S+)/;i=/^([A-Fa-f0-9]*).*/;r=/[\x80-\xFF]/;function w(G){var E,D,F;E=G.toString().split(/[\n\r\f]/);D=E.length;for(F=0;F<D;F+=1){System.print(E[F]);}}function t(E,I){var F,H,G,D;if(k){F="TRACE: "+E+"(";if(I.length>0){H=[];for(G=0;G<I.length;G+=1){D=I[G];if(typeof D==="string"){H.push("'"+D+"'");}else{H.push(D);}}H.concat(I);F+=H.join(",");}F+=")";w(F);}}v=Error;v.prototype=Error.prototype;function u(E){var D;t("parseUri",arguments);D={};f.lastIndex=0;if(E.match(f)){D.scheme=RegExp.$2;D.authority=RegExp.$4;D.path=RegExp.$5;D.query=RegExp.$7;D.fragment=RegExp.$8;}return D;}function x(J){var F,D,I,G,E,H;t("parseHttpUri",arguments);F=u(J);D={};if(F.scheme==="http"){A.lastIndex=0;if(F.authority.match(A)){G=RegExp.$1;E=RegExp.$2;if(G){if(G.length>0){D.host=G;}}D.port=(E)?E:80;H="/";if(F.path){if(F.path.length>0){H=F.path;}}if(F.query){H+="?"+F.query;}D.relRequestURI=H;D.fragment=F.fragment;}}return D;}function e(H){var D,I,F,G,E;t("decodeCP1252",arguments);D="";I=-1;F={128:"\u20AC",129:"\u0081",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",141:"\u008D",142:"\u017D",143:"\u008F",144:"\u0090",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",157:"\u009D",158:"\u017E",159:"\u0178"};for(G=0;G<H.length;G+=1){E=H.charCodeAt(G);if((E<128)||(E>=160)){if(I<0){I=G;}}else{if(I>=0){D+=H.substring(I,G);I=-1;}D+=F[E];}}if(I>=0){D+=H.substring(I);}return D;}function b(H){var D,I,F,G,E;t("decodeISO8859_15",arguments);D="";I=-1;F={164:"\u20AC",166:"\u0160",168:"\u0161",180:"\u017D",184:"\u017E",188:"\u0152",189:"\u0153",190:"\u0178"};for(G=0;G<H.length;G+=1){E=H.charCodeAt(G);if(E in F){if(I>=0){D+=H.substring(I,G);I=-1;}D+=F[E];}else{if(I<0){I=G;}}}if(I>=0){D+=H.substring(I);}return D;}function a(H){var D,I,F,G,E;t("decodeUTF8",arguments);r.lastIndex=0;G=H.search(r);if(G<0){return H;}D="";I=0;F=0;for(;G>=0;G=H.substr(F).search(r)){D+=H.substr(I,G);F+=G;E=H.charCodeAt(F);if((E>=192)&&(E<224)){E=((E&31)<<6)|(H.charCodeAt(F+1)&63);F+=2;}else{if(E<240){E=((E&15)<<12)|((H.charCodeAt(F+1)&63)<<6)|(H.charCodeAt(F+2)&63);F+=3;}else{if(E<248){E=((E&7)<<18)|((H.charCodeAt(F+1)&63)<<12)|((H.charCodeAt(F+2)&63)<<6)|(H.charCodeAt(F+3)&63);F+=4;}else{throw new v("Invalid UTF-8 sequence");}}}if(E<65536){D+=String.fromCharCode(E);}else{D+=String.fromCharCode((E>>10)|55296)+String.fromCharCode((E&1023)|56320);}I=F;}D+=H.substring(I);return D;}z={UNINITIALIZED:0,LOADING:1,LOADED:2,INTERACTIVE:3,COMPLETED:4};function c(){var R=false,an=false,ah=-1,ad="",L=false,P,aq,at=z.UNINITIALIZED,az,ar,F,ag,aB,aA,W,ap,ao={},I,O,M,K,Q,J=false;function H(){t("decodeResponseText",arguments);if(M){switch(ap){case"utf-8":case"utf8":K=a(M);break;case"windows-1252":K=e(M);break;case"iso_8859-15":case"iso-8859-15":K=b(M);break;default:K=M;break;}}}function T(){var aJ,aE,aN,aL,aD,aM,aG,aK,aF,aI;t("parseHTTPHeader",arguments);O={};aJ=I.split("\r\n");aF=aJ.length;for(aE=0;aE<aF;aE+=1){aN=aJ[aE];if(aE<1){s.lastIndex=0;if(aN.match(s)){aL=RegExp.$1;aD=RegExp.$2;aM=RegExp.$3;ad=aD+" "+aM;try{ah=parseInt(aD,10);}catch(aH){throw new v("Invalid HTTP status code: '"+aD+"'");}}else{throw new v("Invalid HTTP response: '"+aN+"'");}}else{aG=aN.indexOf(":");aK=aN.substring(0,aG).toUpperCase();aI=aN.substring(aG+2);O[aK]=aI;}}}function aC(aJ){var aI,aG,aD,aF,aE,aH;t("applyMimeType",arguments);o.lastIndex=0;if(aJ.match(o)){aI=RegExp.$3;if(aI){aG=aI.split(";");aD=aG.length;if(aD>0){for(aF=0;aF<aD;aF+=1){n.lastIndex=0;if(aG[aF].match(n)){aE=RegExp.$1;aH=RegExp.$2;if((aE==="charset")&&(aH)){ap=aH.toLowerCase().replace(/"?([^"]*)"?/,"$1");}}}}}}}function D(){var aD;t("processHTTPHeader",arguments);T();aD=O["CONTENT-TYPE"];if(W){aC(W);}else{if(aD){aC(aD);}}if(O["TRANSFER-ENCODING"]){if(O["TRANSFER-ENCODING"]==="chunked"){an=true;}}}function av(aE){t("setReadyState",arguments);if(at!==aE){at=aE;if(aq){var aD={};aq(aD);}}}function U(aF,aD){t("setRequestHeader",arguments);if(!(az)){throw new v("open() must be called before setRequestHeader()");}if(aD){ao[aF]=aD.toString();}else{try{delete ao[aF];}catch(aE){}}}function ay(){var aF,aE,aD;t("socket_Connect",arguments);if((y)&&(q>0)){aF=az+" http://"+F+":"+ar+ag;}else{aF=az+" "+ag;}aF+=" HTTP/1.0\r\n";U("Host",(ar===80)?F:F+":"+ar);if(aB){U("Content-Length",aB.length);}for(aE in ao){if(ao.hasOwnProperty(aE)){aF+=aE+": "+ao[aE]+"\r\n";}}aF+="\r\n";if(aB){aF+=aB;}I="";M="";Q="";for(aD=0;aD<aF.length;aD+=4096){this.write(aF.substring(aD,aD+4096));}if(P){P();}}function af(aD){var aE;aA.write(aD.length.toString(16)+"\r\n");for(aE=0;aE<aD.length;aE+=4096){aA.write(aD.substring(aE,aE+4096));}aA.write("\r\n");}function V(){t("socket_Close",arguments);this.close();av(z.COMPLETED);}function ac(aE){var aH,aI,aG,aF,aD;if(an){if(J===false){Q+=aE;aH=Q.indexOf("\r\n");while(aH>=0){aI=Q.substring(0,aH);i.lastIndex=0;if(aI.match(i)){aF=RegExp.$1;aD=parseInt(aF,16);if(!aD){J=true;}if(Q.length<aH+2+aD+2){return;}M+=Q.substring(aH+2,aH+2+aD);Q=Q.substring(aH+2+aD+2);}else{throw new v("Invalid HTTP chunk");}aH=Q.indexOf("\r\n");}}}else{M+=aE;}}function au(){var aE,aF,aD;t("socket_Data",arguments);aE=this.read();if(at<z.LOADED){aE=I+aE;aF=aE.indexOf("\r\n\r\n");if(aF>=0){I=aE.substring(0,aF);D();av(z.LOADED);ac(aE.substring(aF+4));if(M.length>0){av(z.INTERACTIVE);}}else{I=aE;}}else{ac(aE);if(M.length>0){av(z.INTERACTIVE);}}aD=new Date();this.time=aD.getTime();}function aw(aD){t("socket_IOError",arguments);System.print("I/O Error:"+aD);System.print("host="+F+", port="+ar);this.close();}function Y(){t("abort",arguments);if(aA){aA.close();}}function aa(){t("getAllResponseHeaders",arguments);return O;}function Z(aD){t("getResponseHeader",arguments);return O[aD];}function ab(aJ,aH,aG,aK,aF){var aE,aD;t("open",arguments);if(az){return Y();}if(at!==z.UNINITIALIZED){throw new v("HttpRequest not in UNINITIALIZED state");}if(aG!==true){throw new v("Synchroneous operation not supported");}if(aJ){az=aJ.toString();}else{az="GET";}if(!(aH)){throw new v("Missing URL");}aE=x(aH.toString());if(!(aE.host)){throw new v("Invalid URL: "+aH);}aD=0;try{aD=parseInt(aE.port,10);}catch(aI){}if((aD<1)||(aD>65535)){throw new v("Invalid port");}ar=aD;F=aE.host;ag=aE.relRequestURI;av(z.LOADING);}function N(aD){t("overrideMimeType",arguments);if(ah<0){throw new v("overrideMimeType() must be called before send()");}if(W){W=aD.toString();}else{W=null;}}function ae(aE){var aD;t("send",arguments);if(!(az)){throw new v("open() must be called before send()");}if(at!==z.LOADING){throw new v("HttpRequest not in LOADING state");}if(aE){aB=aE.toString();}aA=new TCPSocket(false);aA.onClose=V;aA.onConnect=ay;aA.onData=au;aA.onIOError=aw;aA.httpRequest=this;aD=new Date();aA.time=aD.getTime();if((y)&&(q>0)){aA.connect(y,q);}else{aA.connect(F,ar);}}function E(){t("get_responseBinary",arguments);return M;}function G(){t("get_responseText",arguments);if(!(K)){H();}return K;}function aj(){t("get_responseXML",arguments);return new XML(G());}function al(){t("get_readyState",arguments);return at;}function S(){t("get_status",arguments);return ah;}function X(){t("get_statusText",arguments);return ad;}function ai(){t("get_withCredentials",arguments);return L;}function ax(){t("get_onreadystatechange",arguments);return aq;}function ak(aD){t("set_onreadystatechange",arguments);if(!(az)){throw new v("open() must be called before setting onreadystatechange");}aq=aD;}function am(aD){t("set_onconnect",arguments);P=aD;}this.abort=Y;this.getAllResponseHeaders=aa;this.getResponseHeader=Z;this.open=ab;this.overrideMimeType=N;this.send=ae;this.sendChunk=af;this.setRequestHeader=U;this.__defineGetter__("onreadystatechange",ax);this.__defineSetter__("onreadystatechange",ak);this.__defineSetter__("onconnect",am);this.__defineGetter__("readyState",al);this.__defineGetter__("responseText",G);this.__defineGetter__("responseBinary",E);this.__defineGetter__("responseXML",aj);this.__defineGetter__("status",S);this.__defineGetter__("statusText",X);this.__defineGetter__("withCredentials",ai);}function B(E,D){var F=new c();F.open("GET",E,true);F.setRequestHeader("Connection","close");F.onreadystatechange=function(G){if(F.readyState===z.COMPLETED){if(F.status===200){if(D){D(F.responseBinary);}}else{System.print("HTTP status: "+F.status);}}};F.send(null);}function g(E,D){var F=new c();F.open("GET",E,true);F.setRequestHeader("Connection","close");F.setRequestHeader("Accept-Charset","*; q=0.2, ISO-8859-15; q=0.9, ISO-8859-1,utf-8");F.onreadystatechange=function(G){if(F.readyState===z.COMPLETED){if(F.status===200){if(D){D(F.responseText);}}else{System.print("HTTP status: "+F.status);}}};F.send(null);}function d(E,D){var F=new c();F.open("GET",E,true);F.setRequestHeader("Accept","text/xml,application/xml,application/xhtml+xml");F.setRequestHeader("Connection","close");F.setRequestHeader("Accept-Charset","*; q=0.2, ISO-8859-15; q=0.9, ISO-8859-1,utf-8");F.onreadystatechange=function(G){if(F.readyState===z.COMPLETED){if(F.status===200){if(D){D(F.responseXML);}}else{System.print("HTTP status: "+F.status);}}};F.send(null);}function j(H,G,E){var D,F=0,I,J,K;if(typeof G==="string"){D=CF.widget(G);}else{D=G;}if(E){F=parseInt(E,10);}I=new c();I.open("GET",H,true);I.setRequestHeader("Accept","image/*; q=0.2, image/jpeg; q=0.8, image/png");I.onreadystatechange=function(L){if(I.readyState===z.COMPLETED){if(I.status===200){J=I.responseBinary;K=new Image(J);D.setImage(K,F);}else{System.print("HTTP status: "+I.status);}}};I.send(null);}function p(D){if(D){y=D.toString();}else{y=null;}}function m(){return y;}function l(D){q=parseInt(D,10);}function h(){return q;}C=com.philips.HttpLibrary;C.HttpRequest=c;C.parseUri=u;C.parseHttpUri=x;C.getHTTP=g;C.getHTTPBinary=B;C.getHTTPXML=d;C.showHTTPImage=j;C.__defineSetter__("proxyHost",p);C.__defineGetter__("proxyHost",m);C.__defineSetter__("proxyPort",l);C.__defineGetter__("proxyPort",h);}()));/*
  %full_name: leu07hc1#1/ascii/com.philips.Soap.js/11 %
  %created_by: ycl %
  %version: 11 %
  %date_created: Wed Dec  9 17:47:24 2009 %
*/
var com;if(!com){com={};}else{if(typeof com!=="object"){throw new Error("com already exists and is not an object");}}if(!com.philips){com.philips={};}else{if(typeof com.philips!=="object"){throw new Error("com.philips already exists and is not an object");}}if(com.philips.Soap){throw new Error("com.philips.Soap already exists");}com.philips.Soap={};((function(){var c,b=com.philips.Util.printLine,a=com.philips.Util.textToXML;function d(l,h){var k,n,f,e,m,o,r,j,g;function t(w,v){if(!w){throw new Error("Missing URI argument");}if(!v){throw new Error("Missing Namespace argument");}f=w.toString();g=v.toString();k=new Namespace("http://schemas.xmlsoap.org/soap/envelope/");n=new QName(k,"Body");e=0;r=new XML("<x/>");j=new XML('<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><s:Body/></s:Envelope>');}t(l,h);function q(y,z,A,v){var x,w;w=y.elements(n).elements();if((w.namespace().toString()===k.toString())&&(w.localName().toString()==="Fault")){x=w.detail.elements();x.removeNamespace(k);if(m){m(w.faultcode,w.faultstring,x,z,A,v);}else{}}else{if(o){o(w,z,A,v);}else{}}}function s(A,B){var w,z,y,v;z=new Namespace("u",g);w=r.copy();w.setNamespace(z);w.setLocalName(A);for(y in B){if(B.hasOwnProperty(y)){v=r.copy();v.setName(y);v.appendChild(B[y]);w.appendChild(v);}}return w;}function i(z,A,w){var x,y,v;if(!z){throw new Error("Missing aSoapAction parameter");}x=new com.philips.HttpLibrary.HttpRequest();x.method=z;x.args=A;x.tag=w;x.open("POST",f,true);x.setRequestHeader("CONTENT-TYPE",'text/xml; charset="utf-8"');x.setRequestHeader("SOAPACTION",'"'+g+"#"+z+'"');x.onreadystatechange=function(C){var B;if(x.readyState===4){e-=1;if(x.status!==200){}try{B=a(x.responseBinary);}catch(E){return;}try{q(B,x.method,x.args,x.tag);}catch(D){}}};y=j.copy();v=y.elements(n);v.appendChild(s(z,A));e+=1;x.send(y.toString());}function u(v){m=v;}function p(v){o=v;}this.send=i;this.__defineSetter__("onError",u);this.__defineSetter__("onSuccess",p);}c=com.philips.Soap;c.SoapProxy=d;}()));/*
  %full_name: leu07hc1#1/ascii/com.philips.SSDP.js/6 %
  %created_by: ycl %
  %version: 6 %
  %date_created: Wed Dec  9 17:47:23 2009 %
*/
var com;if(!com){com={};}else{if(typeof com!=="object"){throw new Error("com already exists and is not an object");}}if(!com.philips){com.philips={};}else{if(typeof com.philips!=="object"){throw new Error("com.philips already exists and is not an object");}}if(com.philips.SSDP){throw new Error("com.philips.SSDP already exists");}com.philips.SSDP={};(function(){function a(){var t,r=1900,h="239.255.255.250",s,p,q=[];function n(y,v){var w,u,x;u=q.length;for(w=0;w<u;w+=1){x=q[w];if((x.USN===y)&&(x.serviceType===v)){x.index=w;return x;}}}function b(u){}function j(y,v,u,w){var x={};x.USN=y;x.serviceType=v;x.expiration=u;x.location=w;q.push(x);if(p.onAdded){p.onAdded(x);}}function e(y,v){var x,u,w;if(v!=="upnp:rootdevice"){return;}u=q.length;for(w=0;w<u;w+=1){x=q[w];if((x.USN===y)&&(x.serviceType===v)){q.splice(w,1);return;}}}function f(y,v,u,w){var x;if(v!=="upnp:rootdevice"){return;}x=n(y,v);if(x){x.expiration=u;if(x.location!==w){x.location=w;}}else{j(y,v,u,w);}}function c(v){var C,B,D,z,u,x,E,A,y,w;C=v.indexOf("\r\n");if(C<=0){throw new Error("Invalid HTTP header (headerStart="+C+")");}B=v.indexOf("\r\n\r\n");if(B<=0){B=v.length;}D=v.substring(C+2,B);u={};z=D.split("\r\n");for(w in z){if(z.hasOwnProperty(w)){E=z[w];x=E.indexOf(":");A=E.substring(0,x);if(A.substring(0,2)!=="X-"){A=A.toUpperCase();}y=E.substring(x+1).replace(/\s*([^\0]*)\s*/g,"$1");u[A]=y;}}return u;}function g(v){var u,w;if(v["CACHE-CONTROL"]){w=v["CACHE-CONTROL"].split("=");if((w)&&(w.length>=2)){if(w[0].substring(0,7)==="max-age"){u=(new Date()).getTime()+(1000*parseInt(w[1],10));}}}else{if(v.EXPIRES){u=v.EXPIRES;}}return u;}function o(u){f(u.USN,u.NT,g(u),u.LOCATION);}function d(u){e(u.USN,u.NT);}function k(u){f(u.USN,u.ST,g(u),u.LOCATION);}function m(u){var v="M-SEARCH * HTTP/1.1\r\n";v+="S: uuid:"+s+"\r\n";v+="HOST: "+h+":"+r+"\r\n";v+='MAN: "ssdp:discover"\r\n';if(u){v+="ST: "+u+"\r\n";}else{v+="ST: *\r\n";}v+="MX: 3\r\n";v+="\r\n";t.send(v,h,r);}function l(){m("upnp:rootdevice");}function i(){s=Math.uuid();t=new UDPSocket(r);t.onData=function(x,w,u){var z,v;try{if(x.substring(0,8)==="M-SEARCH"){}else{if(x.substring(0,13)==="NOTIFY * HTTP"){v=c(x);if(v.NTS){switch(v.NTS){case"ssdp:alive":o(v);break;case"ssdp:byebye":d(v);break;default:break;}}}else{if(x.substring(0,15)==="HTTP/1.1 200 OK"){v=c(x);k(v);}else{}}}}catch(y){}};t.mcastJoin(h);}this.start=i;this.search=l;p=this;}com.philips.SSDP.SSDPClient=a;}());/*
  %full_name: leu07hc1#1/ascii/com.philips.UPnP.js/25 %
  %created_by: ycl %
  %version: 25 %
  %date_created: Wed Dec  9 17:47:25 2009 %
*/
if(!com){com={};}else{if(typeof com!=="object"){throw new Error("com already exists and is not an object");}}if(!com.philips){com.philips={};}else{if(typeof com.philips!=="object"){throw new Error("com.philips already exists and is not an object");}}if(com.philips.UPnP){throw new Error("com.philips.UPnP already exists");}com.philips.UPnP={};(function(){var w=com.philips.UPnP,p=com.philips.Util.printLine,s=com.philips.Util.textToXML,i,d=new QName(null,"deviceList"),m=new QName(null,"device"),v=new QName(null,"serviceList"),k=new QName(null,"service"),g=new QName(null,"serviceType"),j=new QName(null,"controlURL"),o=new QName(null,"eventSubURL"),c=new QName(null,"manufacturer"),u=new QName(null,"friendlyName"),n=new QName(null,"modelName"),r=new QName(null,"modelNumber"),q=new QName(null,"UDN");function f(y,x,A){var z=new com.philips.HttpLibrary.HttpRequest();z.open("GET",y,true);z.setRequestHeader("Connection","close");z.setRequestHeader("Accept-Charset","*; q=0.2, ISO-8859-15; q=0.9, ISO-8859-1,utf-8");z.onreadystatechange=function(B){if(z.readyState===4){switch(z.status){case 200:case 500:if(x){x(z.responseText,A);}break;default:break;}}};z.send(null);}function l(B,z,x,D){var y,C,A;C=B.elements(g).toString();y=B.elements(j).toString();if(y.length>0){A=new com.philips.Soap.SoapProxy(z+y,C);A.onSuccess=x;A.onError=D;}else{}return A;}function a(z,x,A){var y;y=z.elements(o);LISTENER.subscribe(x,y,A);}function t(z,A){var y,B;if(z.elements(d).length()>0){B=z.elements(d).elements(m).elements(v).elements(k);for(y in B){if(A===B[y].elements(g).toString()){return B[y];}}}B=z.elements(v).elements(k);for(y in B){if(A===B[y].elements(g).toString()){return B[y];}}}function h(E,y){var B,H,D,F;function G(x,I){B=x;D=I;}G(E,y);function C(K,J){var I,x;I=s(K).elements(m);J.manufacturer=I.elements(c).toString();J.friendlyName=I.elements(u).toString();J.modelName=I.elements(n).toString();J.modelNumber=I.elements(r).toString();J.UDN=I.elements(q).toString();if((!i)||(i(J))){x=t(I,"urn:schemas-upnp-org:service:AVTransport:1");if(x!==undefined){J.avtProxy=new w.AVTProxy(x,D,B);}x=t(I,"urn:schemas-upnp-org:service:ContentDirectory:1");if(x!==undefined){J.cdProxy=new w.CDProxy(x,D,B);}x=t(I,"urn:schemas-upnp-org:service:RenderingControl:1");if(x!==undefined){J.rcProxy=new w.RCProxy(x,D,B);}}}function z(x,I){f(B+x,C,I);}function A(){}H=this;this.info=A;this.detect=z;}function e(z,x,D){var y,A,C,B;if(x!==undefined){C=z;B=x;}else{y=com.philips.HttpLibrary.parseHttpUri(z);if((y===undefined)||(y.host===undefined)){return;}C="http://"+y.host+":"+y.port;B=y.relRequestURI;}A=new h(C,D);A.detect(B,A);}function b(x){i=x;}w.detectServer=e;w.createControlProxy=l;w.eventSubscribe=a;w.UPNPHost=h;w.__defineSetter__("onNewHost",b);}());/*
  %full_name: leu07hc1#1/ascii/upnp-AVTProxy.js/22 %
  %created_by: ycl %
  %version: 22 %
  %date_created: Wed Dec  9 17:47:34 2009 %
*/
(function(){var m=com.philips.UPnP,a=com.philips.Util.printLine,j=new QName(null,"errorCode"),h=new Namespace("urn:schemas-upnp-org:metadata-1-0/DIDL-Lite/"),b=new Namespace("urn:schemas-upnp-org:metadata-1-0/upnp/"),l=new Namespace("http://purl.org/dc/elements/1.1/"),g=new QName(h,"item"),c=new QName(h,"res"),n=new QName(l,"title"),k=new QName(l,"creator"),o=new QName(b,"album"),d=new QName(b,"albumArtURI"),i;i={401:"INVALID_ACTION",402:"INVALID_ARGS",403:"OUT_OF_SYNC",404:"INVALID_VAR",412:"PRECONDITION_FAILED",501:"ACTION_FAILED",600:"ARGUMENT_VALUE_INVALUD",601:"ARGUMENT_VALUE_RANGE",602:"OPT_ACTION_NOT_IMPLEMENTED",603:"OUT_OF_MEMORY",604:"HUMAN_INTERVENTION",605:"STRING_ARG_TOO_LONG",701:"INVALID_TRANSITION",702:"NO_CONTENTS",703:"READ_ERROR",704:"UNSUPPORTED_PLAY_FORMAT",705:"TRANSPORT_LOCKED",706:"WRITE_ERROR",707:"PROTECTED_MEDIA",708:"UNSUPPORTED_REC_FORMAT",709:"FULL_MEDIA",710:"UNSUPPORTED_SEEK_MODE",711:"ILLEGAL_SEEK_TARGET",712:"UNSUPPORTED_PLAY_MODE",713:"UNSUPPORTED_REC_QUALITY",714:"ILLEGAL_MIME",715:"CONTENT_BUSY",716:"RESOURCE_NOT_FOUND",717:"UNSUPPORTED_PLAY_SPEED",718:"INVALID_INSTANCE_ID"};function f(q){var r,s,p,t;t=q.toString();if(t.length>0){p=0;s=t.split(":");for(r=0;r<s.length;r+=1){p*=60;p+=parseInt(s[r],10);}}return p;}function e(Y,am,O){var v,s,A,af,ad,ah,y,M,r,F,an;function I(au,aq,ap,aw,ao,ar){var av,at,ax;av=parseInt(ap.elements(j),10);at=i[av];if(at){}else{}if(av===800){ax="Unable to play the selected item\n(UPnP error: 800)";GUI.alert(ax);}}function K(ao){if(v){v.send("Stop",{InstanceID:ao});}}function N(ap,ao,aq){if(v){v.send("Seek",{InstanceID:ap,Unit:ao,Target:aq});}}function Q(ao,ap){if(v){v.send("Play",{InstanceID:ao,Speed:ap});}}function p(ao){if(v){v.send("Pause",{InstanceID:ao});}}function B(ao){if(v){v.send("PreviousSection",{InstanceID:ao});}}function V(ao){if(v){v.send("NextSection",{InstanceID:ao});}}function aa(ao){if(v){v.send("Previous",{InstanceID:ao});}}function t(ao){if(v){v.send("Next",{InstanceID:ao});}}function x(ap,ao){if(v){v.send("SetPlayMode",{InstanceID:ap,NewPlayMode:ao});}}function L(ap,ao,aq,at,ar){if(v){v.send("AddURIToQueue",{InstanceID:ap,EnqueuedURI:ao,EnqueuedURIMetaData:aq,DesiredFirstTrackNumberEnqueued:at,EnqueueAsNext:ar});}}function H(ao,ap){if(v){v.send("RemoveTrackFromQueue",{InstanceID:ao,ObjectID:ap});}}function u(ao){if(v){v.send("RemoveAllTracksFromQueue",{InstanceID:ao});}}function S(aq,ao,ap){if(v){v.send("SetAVTransportURI",{InstanceID:aq,CurrentURI:ao,CurrentURIMetaData:ap});}}function U(ao){if(ao){af.dirty=false;af.transportState=s.TransportState;af.time=(new Date()).getTime();af.current=f(ao);}if(y){y(af);}else{}}function E(ax){try{var ao,at,aw,au,ar,aq,ap,az,ay;ao=new XML(ax);az=ao.elements(g);at=az.elements(c).attribute("duration").toString();aw=az.elements(n).toString();au=az.elements(k).toString();ar=az.elements(o).toString();ap=az.elements(d).toString();ad.duration=at;ad.title=aw;ad.artist=au;ad.album=ar;if(ap===""){ad.albumArtURI=undefined;}else{if(ap.substring(0,7)==="http://"){ad.albumArtURI=ap;}else{ad.albumArtURI=O+ap;}}aq=f(at);if(aq!==af.duration){af.duration=aq;af.current=0;}if(ah){ah(ad);}U();}catch(av){}}function w(ao){var ap;switch(ao){case"ERROR_NO_RESOURCE":ap="Player cannot find item on file server";break;case"ERROR_CANT_RESOLVE_NAME":ap="Player cannot connect to file server";break;default:ap=ao;break;}GUI.alert("Player error:\n"+ap);}function C(ao){GUI.alert("A/V Transport error:\n"+ao);}function q(ap,ao,aq){var ar;if(aq===undefined){return;}ar=aq.toString();switch(ao){case"TransportStatus":if(ar!=="OK"){w(ar);}break;case"TransportErrorDescription":break;default:break;}if(s[ao]===ar){return;}s[ao]=ar;switch(ao){case"CurrentTrackMetaData":af.dirty=true;E(ar);break;case"RelativeTimePosition":U(aq);break;case"CurrentPlayMode":if(an){an(ar);}break;case"TransportState":if(af.transportState!==ar){af.dirty=true;}if(F){F(ar);}break;default:break;}}function Z(au,ar,at,ao){var aq,ap=au.localName();aq="0";switch(ap){case"AddURIToQueueResponse":DISPATCH.reportAddQueueSuccess(au.NumTracksAdded.toString());break;case"SaveQueueResponse":break;case"GetMediaInfoResponse":q(aq,"NumberOfTracks",au.NrTracks);q(aq,"CurrentMediaDuration",au.MediaDuration);q(aq,"AVTransportURI",au.CurrentURI);q(aq,"AVTransportURIMetaData",au.CurrentURIMetaData);q(aq,"NextAVTransportURI",au.NextURI);q(aq,"NextAVTransportURIMetaData",au.NextURIMetaData);q(aq,"PlaybackStorageMedium",au.PlayMedium);q(aq,"RecordStorageMedium",au.RecordMedium);q(aq,"RecordMediumWriteStatus",au.WriteStatus);break;case"GetTransportInfoResponse":q(aq,"TransportState",au.CurrentTransportState);q(aq,"TransportStatus",au.CurrentTransportStatus);q(aq,"TransportPlaySpeed",au.CurrentSpeed);break;case"GetPositionInfoResponse":q(aq,"CurrentTrack",au.Track);q(aq,"CurrentTrackDuration",au.TrackDuration);if(au.TrackMetaData.toString()!=="NOT_IMPLEMENTED"){q(aq,"CurrentTrackMetaData",au.TrackMetaData);}q(aq,"CurrentTrackURI",au.TrackURI);q(aq,"RelativeTimePosition",au.RelTime);q(aq,"AbsoluteTimePosition",au.AbsTime);q(aq,"RelativeCounterPosition",au.RelCount);q(aq,"AbsoluteCounterPosition",au.AbsCount);break;case"GetDeviceCapabilitiesResponse":q(aq,"PossiblePlaybackStorageMedia",au.PlayMedia);q(aq,"PossibleRecordStorageMedia",au.RecMedia);q(aq,"PossibleRecordQualityModes",au.RecQualityModes);break;case"GetTransportSettingsResponse":q(aq,"CurrentPlayMode",au.PlayMode);q(aq,"CurrentRecordQualityMode",au.RecQualityMode);break;case"GetCurrentTransportActionsResponse":q(aq,"CurrentTransportActions",au.Actions);break;case"GetRemainingSleepTimerDurationResponse":q(aq,"SleepTimerGeneration",au.CurrentSleepTimerGeneration);break;case"GetRunningAlarmPropertiesResponse":q(aq,"AlarmIDRunning",au.AlarmID);q(aq,"AlarmLoggedStartTime",au.LoggedStartTime);break;case"RemoveAllTracksFromQueueResponse":if(M){M();}DISPATCH.setResponseText("Queue cleared");break;case"RemoveTrackFromQueueResponse":if(r){r();}DISPATCH.setResponseText("Track removed from queue");break;case"PauseResponse":q(at.instanceID,"TransportState","PAUSED_PLAYBACK");DISPATCH.reportOk();break;case"PlayResponse":q(at.instanceID,"TransportState","PLAYING");DISPATCH.reportOk();break;case"StopResponse":q(at.instanceID,"TransportState","STOPPED");DISPATCH.reportOk();break;case"SetPlayModeResponse":q(at.instanceID,"CurrentPlayMode",at.NewPlayMode);DISPATCH.reportOk();break;case"SetAVTransportURIResponse":q(at.instanceID,"AVTransportURI",at.CurrentURI);q(at.instanceID,"AVTransportURIMetaData",at.aCurrentURIMetaData);DISPATCH.reportOk();break;default:break;}}function al(){A.add(function(){if(v){v.send("GetPositionInfo",{InstanceID:0});}});A.add(function(){if(v){v.send("GetMediaInfo",{InstanceID:0});}});A.add(function(){if(v){v.send("GetTransportInfo",{InstanceID:0});}});A.add(function(){if(v){v.send("GetDeviceCapabilities",{InstanceID:0});}});A.add(function(){if(v){v.send("GetTransportSettings",{InstanceID:0});}});}function ac(){if(v){v.send("GetPositionInfo",{InstanceID:0});}}function X(){A.add(function(){if(v){v.send("GetDeviceCapabilities",{InstanceID:0});}});}function J(ao){ah=ao;}function ab(ao){y=ao;}function ak(ao){M=ao;}function T(ao){r=ao;}function G(ao){F=ao;}function z(ao){an=ao;}function D(ao){return ad;}function W(ao){return af;}function ag(ao){return s.TransportState;}function R(ao){return s.AVTransportURI;}function aj(ao){return s.CurrentPlayMode;}function ae(at){var ar,aA,ao,aC,aB,au,av,az,ay,ax,aq,ap,aw;ar=new XML(at);ao=ar.children();aC=ao.length();for(aq=0;aq<aC;aq+=1){aA=ao[aq];aB=aA.attribute("val")[0];au=aA.children();av=au.length();for(ap=0;ap<av;ap+=1){az=au[ap];ay=az.localName();ax=az.attribute("val")[0];q(aB,ay,ax);}}}function P(ap,ao){if(ap==="LastChange"){ae(ao);}else{}}function ai(ap,aq,ao){v=m.createControlProxy(ap,ao,function(av,at,au,ar){Z(av,at,au,ar);},I);m.eventSubscribe(ap,ao,function(at,ar){P(at,ar);});s={};A=aq;ad={};af={};al();X();}ai(Y,am,O);this.refresh=al;this.updateCurrent=ac;this.previoussection=B;this.nextsection=V;this.previous=aa;this.next=t;this.play=Q;this.pause=p;this.stop=K;this.seek=N;this.adduritoqueue=L;this.removetrackfromqueue=H;this.removealltracksfromqueue=u;this.setavtransporturi=S;this.getTransportState=ag;this.getPlayMode=aj;this.setPlayMode=x;this.getTrackInfo=D;this.getPosition=W;this.getAVTransportURI=R;this.__defineSetter__("onTrackInfo",J);this.__defineSetter__("onPosition",ab);this.__defineSetter__("onQueueCleared",ak);this.__defineSetter__("onQueueChanged",T);this.__defineSetter__("onTransportStateChange",G);this.__defineSetter__("onPlayModeChange",z);}m.AVTProxy=e;}());/*
  %full_name: leu07hc1#1/ascii/upnp-CDProxy.js/9 %
  %created_by: ycl %
  %version: 9 %
  %date_created: Wed Dec  9 17:47:36 2009 %
*/
(function(){var d=com.philips.UPnP,c=com.philips.Util.printLine,e=new QName(null,"errorCode"),b;b={401:"INVALID_ACTION",402:"INVALID_ARGS",403:"OUT_OF_SYNC",404:"INVALID_VAR",412:"PRECONDITION_FAILED",501:"ACTION_FAILED",600:"ARGUMENT_VALUE_INVALUD",601:"ARGUMENT_VALUE_RANGE",602:"OPT_ACTION_NOT_IMPLEMENTED",603:"OUT_OF_MEMORY",604:"HUMAN_INTERVENTION",605:"STRING_ARG_TOO_LONG",701:"NO_SUCH_OBJECT",702:"INVALID_CURRENTTAGVALUE",703:"INVALID_NEWTAGVALUE",704:"REQUIRED_TAG_DELETE",705:"READONLY_TAG_UPDATE",706:"PARAMETER_NUM_MISMATCH",708:"BAD_SEARCH_CRITERIA",709:"BAD_SORT_CRITERIA",710:"NO_SUCH_CONTAINER",711:"RESTRICTED_OBJECT",712:"BAD_METADATA",713:"RESTRICTED_PARENT_OBJECT",714:"NO_SUCH_SOURCE_RESOURCE",715:"SOURCE_RESOURCE_ACCESS_DENIED",716:"TRANSFER_BUSY",717:"NO_SUCH_FILE_TRANSFER",718:"NO_SUCH_DESTINATION_RESOURCE",719:"DESTINATION_RESOURCE_ACCESS_DENIED",720:"REQUEST_FAILED"};function a(t,f,n){var o,h,m,s;function k(C,y,x,E,w,z){var D,B,A,F;D=parseInt(x.elements(e),10);B=b[D];if(B){A=B;}else{A=x.toString();}if(E==="Browse"){F="Browse "+z.title+" failed:\n"+A;GUI.alert(F);}}function q(C,z,y,B,A,x,w){if(o){o.send("Browse",{ObjectID:C,BrowseFlag:z,Filter:y,StartingIndex:B,RequestedCount:A,SortCriteria:x},w);}}function p(x,y,w){if(o){o.send("CreateObject",{ContainerID:x,Elements:y},w);}}function l(x,y,w){if(o){o.send("CreateReference",{ContainerID:x,ObjectID:y},w);}}function v(A,z,y,C,B,x,w){if(o){o.send("Search",{ContainerID:A,SearchCriteria:z,Filter:y,StartingIndex:C,RequestedCount:B,SortCriteria:x},w);}}function j(w){if(o){o.send("RefreshShareList",{},w);}}function r(x,w){if(o){o.send("RefreshShareIndex",{AlbumArtistDisplayOption:x},w);}}function i(A,y,z,w){var x=A.localName();switch(x){case"BrowseResponse":if(h){h(A,y,z,w);}break;case"RefreshShareIndexResponse":DISPATCH.setResponseText("Updating music index...");break;default:break;}}function u(x,y,w){o=d.createControlProxy(x,w,function(C,A,B,z){i(C,A,B,z);},k);m=y;}u(t,f,n);function g(w){h=w;}this.browse=q;this.search=v;this.createobject=p;this.createreference=l;this.refreshsharelist=j;this.refreshshareindex=r;this.__defineSetter__("onBrowseResponse",g);}d.CDProxy=a;}());/*
  %full_name: leu07hc1#1/ascii/upnp-RCProxy.js/11 %
  %created_by: ycl %
  %version: 11 %
  %date_created: Wed Dec  9 17:47:36 2009 %
*/
(function(){var b=com.philips.UPnP,a=com.philips.Util.printLine,c=new QName(null,"errorCode"),d;d={401:"INVALID_ACTION",402:"INVALID_ARGS",403:"OUT_OF_SYNC",404:"INVALID_VAR",412:"PRECONDITION_FAILED",501:"ACTION_FAILED",600:"ARGUMENT_VALUE_INVALUD",601:"ARGUMENT_VALUE_RANGE",602:"OPT_ACTION_NOT_IMPLEMENTED",603:"OUT_OF_MEMORY",604:"HUMAN_INTERVENTION",605:"STRING_ARG_TOO_LONG",701:"INVALID_NAME",702:"INVALID_INSTANCEID"};function e(A,u,z){var g,v,r,h,n;function j(C,D,H,F,G,B){var E,x;E=parseInt(H.elements(c),10);x=d[E];if(x){}else{}}function l(B,E,x,C){var D=(C===undefined)?undefined:C.toString();if((E)&&(E!=="Master")){return;}if(v[x]===D){return;}v[x]=D;switch(x){case"Mute":case"Volume":if(h){h();}break;default:break;}}function t(G,E,F,x){var B=G.localName(),C=0,D="Master";switch(B){case"GetMuteResponse":l(C,D,"Mute",G.CurrentMute);break;case"SetMuteResponse":l(C,D,"Mute",F.DesiredMute);break;case"GetVolumeResponse":l(C,D,"Volume",G.CurrentVolume);break;case"SetRelativeVolumeResponse":l(C,D,"Volume",G.NewVolume);break;case"SetVolumeResponse":l(C,D,"Volume",F.DesiredVolume);break;default:break;}}function p(x,C,B){g.send("SetMute",{InstanceID:x,Channel:C,DesiredMute:B});}function f(B,C,x){g.send("SetRelativeVolume",{InstanceID:B,Channel:C,Adjustment:x});}function o(B,C,x){g.send("SetVolume",{InstanceID:B,Channel:C,DesiredVolume:x});}function y(x,B){return v.Mute;}function q(x,B){return v.Volume;}function i(){r.add(function(){if(g){g.send("GetMute",{InstanceID:0,Channel:"Master"});}});r.add(function(){if(g){g.send("GetVolume",{InstanceID:0,Channel:"Master"});}});}function m(G){var E,N,B,P,O,H,I,M,L,K,F,D,C,J;E=new XML(G);B=E.children();P=B.length();for(D=0;D<P;D+=1){N=B[D];O=N.attribute("val")[0];H=N.children();I=H.length();for(C=0;C<I;C+=1){M=H[C];L=M.localName();K=M.attribute("val")[0];F=M.attribute("channel")[0];l(O,F,L,K);}}}function w(B,x){if(B==="LastChange"){m(x);}else{}}function s(B,C,x){v={};g=b.createControlProxy(B,x,function(G,E,F,D){t(G,E,F,D);},j);b.eventSubscribe(B,x,function(E,D){w(E,D);});r=C;i();}s(A,u,z);function k(x){h=x;}this.refresh=i;this.setMute=p;this.getMute=y;this.getVolume=q;this.setRelativeVolume=f;this.setVolume=o;this.__defineSetter__("onVolumeChange",k);}b.RCProxy=e;}());/*
  %full_name: leu07hc1#1/ascii/upnp-Browser.js/10 %
  %created_by: ycl %
  %version: 10 %
  %date_created: Wed Dec  9 17:47:35 2009 %
*/
(function(){var b=com.philips.UPnP,a=com.philips.Util.printLine;function c(d){var n,k,h,l;function i(t,s){var x,y,D,C,B,E,z,G,u,H,F,A,w,v,I,r;I=[];y=t.child(0).toString();x=new XML(y);E=x.elements();F=E.length();B=0;for(D=0;D<F;D+=1){A=E[D].attribute("id").toString();w=E[D].elements();v=w.length();G=undefined;H=undefined;u=undefined;for(C=0;C<v;C+=1){z=w[C];switch(z.localName()){case"title":G=com.philips.Util.decodeUTF8(z.toString());break;case"res":H=z.toString();break;case"class":u=z.toString();break;default:break;}}if((!s)||(s&&(G.toLowerCase().indexOf(s)>=0))){r={};r.id=A;r.title=G;if(u){r.type=u;if(u.substring(0,16)==="object.container"){r.menu=true;}}r.res=H;I[B]=r;B+=1;}}return I;}function e(x,v,w,r){var t=x.localName(),s,u,y;if(t!=="BrowseResponse"){return;}if(!k){return;}if(h!==r.id){return;}s=i(x.Result,r.filter);u=parseInt(w.StartingIndex.toString(),10);y=u+parseInt(x.NumberReturned.toString(),10);if(y>=x.TotalMatches){r.done=true;}if((s.length>0)||(r.done)){k(s,r,u);}if(y<x.TotalMatches){n.browse(w.ObjectID,w.BrowseFlag,w.Filter,y,64,w.SortCriteria,r);}}function g(){h+=1;if(h>4096){h=0;}return h;}function j(s,t){var r={};if(!n){throw new Error("No CD Proxy set");}r.title=t;r.id=g();n.browse(s,"BrowseDirectChildren","*",0,8,"",r);}function q(t,u,s){var r={};if(!n){throw new Error("No CD Proxy set");}r.title=u;r.id=g();r.filter=s.toLowerCase();n.browse(t,"BrowseDirectChildren","*",0,8,"",r);}function p(){g();}function o(){h=0;}o();function m(r){g();k=r;}function f(r){g();n=r;if(n){n.onBrowseResponse=e;}}this.browse=j;this.search=q;this.cancel=p;this.__defineSetter__("onBrowseResult",m);this.__defineSetter__("cdProxy",f);}b.Browser=c;}());/*
  %full_name: leu07hc1#1/ascii/module-artcache.js/4 %
  %created_by: ycl %
  %version: 4 %
  %date_created: Wed Dec  9 17:47:28 2009 %
*/
var ARTCACHE={};(function(){var c,a;function b(e){var d;if(e===a){if(ARTCACHE.onArt){ARTCACHE.onArt(c,a);}}else{d=new com.philips.HttpLibrary.HttpRequest();d.open("GET",e,true);d.setRequestHeader("Accept","image/*; q=0.2, image/jpeg; q=0.8, image/png");d.onreadystatechange=function(f){var g;if(d.readyState===4){if(d.status===200){g=d.responseBinary;c=new Image(g);if((c.width===0)||(c.height===0)){c=undefined;}a=e;if(ARTCACHE.onArt){ARTCACHE.onArt(c,a);}}else{}}};d.send(null);}}ARTCACHE.fetch=b;}());/*
  %full_name: leu07hc1#1/ascii/module-dispatch.js/7 %
  %created_by: ycl %
  %version: 7 %
  %date_created: Wed Dec  9 17:47:28 2009 %
*/
var DISPATCH={};(function(){var k,h="",e;DISPATCH.pageExit=function(){if(DISPATCH.popup){DISPATCH.popup.remove();}};function a(){var m,l;l=k.length;for(m=0;m<l;m+=1){k[m]();}}function d(l){k.push(l);}function i(m){var l;l=k.indexOf(m);if(l>=0){k.splice(l,1);}}function f(l){h=l;if(e){e.label=h;}}function c(l){var m=0;m=parseInt(l,10);if(m===1){f("1 track added to queue");}else{f(m+" tracks added to queue");}}function b(){f("");}function g(l){e=l;if(l){l.label=h;}}function j(){var l;k=[];l=new com.philips.Util.PeriodicTimer();l.setInterval(1000);l.setCallback(a);l.start();}j();DISPATCH.addTicker=d;DISPATCH.removeTicker=i;DISPATCH.setResponseWidget=g;DISPATCH.setResponseText=f;DISPATCH.reportAddQueueSuccess=c;DISPATCH.reportOk=b;}());/*
  %full_name: leu07hc1#1/ascii/module-listener.js/8 %
  %created_by: ycl %
  %version: 8 %
  %date_created: Wed Dec  9 17:47:29 2009 %
*/
var LISTENER={};(function(){var z,q,d,o,t,f,i=300,c=60,b,n;q=/^([A-Z\/\.0-9]*) ([0-9]*) (.*)/;d=/^([A-Z]*) ([^\s]*) ([^\s]*)/;function y(C){var H,B,L,J,E,I,D,A,K,G;A={};H=C.split("\r\n");D=H.length;K={};for(B=0;B<D;B+=1){L=H[B];if(B<1){q.lastIndex=0;d.lastIndex=0;if(L.match(q)){J=RegExp.$3;try{K.statusNumber=parseInt(RegExp.$2,10);}catch(F){throw new Error("Invalid HTTP status code: '"+K.statusNumber+"'");}K.statusText=K.statusNumber+" "+J;}else{if(L.match(d)){K.method=RegExp.$1;K.uri=RegExp.$2;K.protocol=RegExp.$3;}else{throw new Error("Invalid HTTP response: '"+L+"'");}}}else{E=L.indexOf(":");I=L.substring(0,E).toUpperCase();G=L.substring(E+2);A[I]=G;}}K.headers=A;return K;}function h(){var M,L,E,F,C,H,K,D,G,B,A,J,I;L=this.data.indexOf("\r\n\r\n");M=this.data.substring(0,L);E=y(M);F=this.data.substring(L+4);C=new XML(F);B=E.headers.SID;if(B){A=b[B];if(A){H=C.children();G=H.length();for(D=0;D<G;D+=1){K=H[D].children()[0];J=K.localName();I=K.toString();if(A.onPropChange){A.onPropChange(J,I);}}}else{}}else{}}function e(){this.data+=this.read();}function j(A){}function l(A){A.onClose=h;A.onData=e;A.onIOError=j;A.data="";}function p(A){}function v(A){}function u(){this.data+=this.read();}function k(){this.write(this.request);}function s(){var C,D,B,E,A;D=this.data.indexOf("\r\n\r\n");if(D>=0){C=this.data.substring(0,D);}else{C=this.data;}E=y(C);B=E.headers.SID;if(this.sub.sid){if(B===this.sub.sid){this.sub.expiry=(new Date()).getTime()+(c*1000);}else{if(E.statusNumber===412){delete b[this.sub.sid];delete this.sub.sid;delete this.sub.expiry;this.sub.broken=true;n.push(this.sub);}else{}}}else{if(B){if(b[B]){}else{this.sub.sid=B;this.sub.expiry=(new Date()).getTime()+(c*1000);b[B]=this.sub;if(this.sub.broken){delete this.sub.broken;A=n.indexOf(this.sub);if(A>=0){n.splice(A,1);}else{}}else{}}}else{}}}function w(C,A){var B;B=new TCPSocket(false);B.sub=C;B.request=A;B.data="";B.onIOError=v;B.onConnect=k;B.onClose=s;B.onData=u;B.connect(C.host,C.port);}function a(C){var B,A;B="SUBSCRIBE http://"+C.host+":"+C.port+C.relURI+" HTTP/1.1\r\n";B+="HOST: "+C.host+":"+C.port+"\r\n";B+="CALLBACK: <http://"+System.getIPAddress()+":"+t+"/>\r\n";B+="NT: upnp:event\r\n";B+="TIMEOUT: Second-"+i+"\r\n";B+="\r\n";w(C,B);}function m(C){var B,A;B="SUBSCRIBE http://"+C.host+":"+C.port+C.relURI+" HTTP/1.1\r\n";B+="HOST: "+C.host+":"+C.port+"\r\n";B+="SID: "+C.sid+"\r\n";B+="TIMEOUT: Second-"+i+"\r\n";B+="\r\n";w(C,B);}function g(D,H,G){var C,A,F,E,B;if(H.substring(0,7)==="http://"){A=com.philips.HttpLibrary.parseHttpUri(H);F=A.relRequestURI+A.fragment;}else{A=com.philips.HttpLibrary.parseHttpUri(D);F=H;}C={};C.host=A.host;C.port=A.port;C.relURI=F;C.onPropChange=G;a(C);}function x(){var C,A,D,B;B=(new Date()).getTime();for(C in b){if(b.hasOwnProperty(C)){D=b[C];if(D.expiry<B){m(D);}}}A=n.length;for(C=0;C<A;C+=1){D=n[C];a(D);}}function r(){var A;b=[];n=[];t=9128;A=new com.philips.Util.PeriodicTimer();A.setInterval(1000*60);A.setCallback(x);A.start();f=new TCPSocket(false);f.onConnect=l;f.onIOError=p;f.listen(t);}LISTENER.init=r;LISTENER.subscribe=g;}());/*
  %full_name: leu07hc1#1/ascii/module-volume.js/9 %
  %created_by: ycl %
  %version: 9 %
  %date_created: Wed Dec  9 17:47:30 2009 %
*/
var VOLUME={};(function(){var n,l,r,b,d,h,p=100,g=100,e;function f(){var u;r.visible=(e==="1");u=0;if(g){u=Math.round(g*b.fullWidth/100);}if(u>0){b.width=u;b.visible=true;}else{b.visible=false;}}function o(){var v,u,z,y,A,x;l=[];y=GUI.width*1/10;u=GUI.width*8/10;A=GUI.height*3/10;z=GUI.height*3/10;v=GUI.addPanel();v.left=y;v.width=u;v.top=A;v.height=z;v.bgcolor=COLORS.gray;v.visible=true;l.push(v);v=GUI.addPanel();v.color=COLORS.blue;v.left=y+(u*1/20);v.width=(u*18/20);v.top=A+(z*1/10);v.height=GUI.height/12;v.fontSize=GUI.height/12;v.transparent=true;v.halign="left";v.valign="top";v.label="Volume";v.visible=true;l.push(v);v=GUI.addPanel();v.color=COLORS.black;v.bgcolor=COLORS.white;v.left=y+(u*1/20);v.width=GUI.height*2/12;v.top=A+(z*5/10);v.height=GUI.height/10;v.fontSize=GUI.height/12;v.transparent=false;v.halign="center";v.valign="center";v.label="\uF0F0";l.push(v);r=v;v=GUI.addPanel();v.left=y+(u*1/20)+(GUI.height*3/12);v.top=A+(z*6/10);v.height=GUI.height/15;v.width=u-((u*2/20)+(GUI.height*3/12));v.bgcolor=COLORS.blue;v.visible=true;l.push(v);v=GUI.addPanel();v.left=y+(u*1/20)+(GUI.height*3/12)+2;v.top=A+(z*6/10)+2;v.height=(GUI.height/15)-4;v.fullWidth=u-((u*2/20)+(GUI.height*3/12))-4;v.bgcolor=COLORS.red;l.push(v);b=v;f();}function k(){h=(new Date()).getTime()+2000;}function a(){if(!n){return;}e=d.getMute(0,"Master");p=parseInt(d.getVolume(0,"Master"),10);f();}function q(){var u;if(!n){return;}u=(new Date()).getTime();if(u>h){VOLUME.remove();}}function s(){var u;e=d.getMute(0,"Master");u=d.getVolume(0,"Master");p=(u===undefined)?undefined:parseInt(u,10);if(n){}else{if(DISPATCH.popup){DISPATCH.popup.remove();}DISPATCH.popup=VOLUME;DISPATCH.addTicker(q);d.onVolumeChange=a;g=p;o();n=true;}k();}function m(){if(!UPNPTEST.myHost){return;}d=UPNPTEST.myHost.rcProxy;if(!d){return;}s();if(e){e=(e==="0")?"1":"0";}else{e="1";}d.setMute(0,"Master",e);}function c(u){if(g===undefined){g=p;}if(g!==undefined){g+=u;if(g<0){g=0;}else{if(g>100){g=100;}}}f();if(p===undefined){d.setRelativeVolume(0,"Master",u);}else{if(p!==g){d.setVolume(0,"Master",g);}}}function i(){if(!UPNPTEST.myHost){return;}d=UPNPTEST.myHost.rcProxy;if(!d){return;}s();c(10);}function j(){if(!UPNPTEST.myHost){return;}d=UPNPTEST.myHost.rcProxy;if(!d){return;}s();c(-10);}function t(){var x,u,v;if(d){d.onVolumeChange=undefined;}if(n){if(DISPATCH.popup===VOLUME){DISPATCH.popup=undefined;}DISPATCH.removeTicker(q);u=l?l.length:0;for(x=0;x<u;x+=1){v=l[x];if(v){v.remove();}}}l=undefined;r=undefined;n=undefined;d=undefined;e=undefined;h=undefined;}VOLUME.toggleMute=m;VOLUME.up=i;VOLUME.down=j;VOLUME.remove=t;}());/*
  %full_name: leu07hc1#1/ascii/page-KEYBOARD.js/9 %
  %created_by: ycl %
  %version: 9 %
  %date_created: Wed Dec  9 17:47:31 2009 %
*/
var KBDTEST={};(function(){var f,d;function e(){var g;d=GUI.widget("TRANSPORT_STATE");g=GUI.widget("PAGE_TITLE");if(UPNPTEST.action){g.label=UPNPTEST.action.title;}}function c(){GUI.widget("PS_FIRM1").label="Shift";GUI.widget("PS_FIRM3").label="Cancel";GUI.widget("PS_FIRM5").label="Search";["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5"].forEach(function(g){var h;h=GUI.widget(g);h.setColor(COLORS.white,0);h.setColor(COLORS.white,1);h.fontSize=13;});GUI.widget("PS_FIRM1").onPress=function(){KBDTEST.kbd.Shift();};GUI.widget("PS_FIRM3").onPress=function(){UPNPTEST.action=undefined;UPNPTEST.jump("MUSICMENU");};GUI.widget("PS_FIRM5").onPress=function(){var g;if(UPNPTEST.action){g=KBDTEST.kbd.value;UPNPTEST.action.text=g;}UPNPTEST.jump("MUSICMENU");};GUI.widget("PS_OK").onPress=function(){KBDTEST.kbd.OK();};}function b(){var g;e();c();g=new com.philips.KBD.KeyBoard();g.init();KBDTEST.kbd=g;CF.activity().onRotary=function(h){if(h<0){KBDTEST.kbd.PrevKey();}else{if(h>0){KBDTEST.kbd.NextKey();}}};}function a(){DISPATCH.pageExit();f=undefined;}KBDTEST.pageEntry=b;KBDTEST.pageExit=a;CF.activity().page("KEYBOARD").onEntry=function(){KBDTEST.pageEntry();};CF.activity().page("KEYBOARD").onExit=function(){KBDTEST.pageExit();};}());/*
  %full_name: leu07hc1#1/ascii/page-MENU.js/34 %
  %created_by: ycl %
  %version: 34 %
  %date_created: Wed Dec  9 17:47:31 2009 %
*/
var MENUTEST={};(function(){var m,c,s,v,o,u,p,j;function l(B,D,C){var A={};A.operation="SEARCH";A.container=B;A.title="Search: "+D;UPNPTEST.action=A;UPNPTEST.jump("KEYBOARD");}o={title:"Search",menu:[{title:"Artists",menu:true,action:function(){l("A:ALBUMARTIST","Artists","dc:creator");}},{title:"Albums",menu:true,action:function(){l("A:ALBUM","Albums","dc:title");}},{title:"Composers",menu:true,action:function(){l("A:COMPOSER","Composers","dc:creator");}},{title:"Tracks",menu:true,action:function(){l("A:TRACKS","Tracks","dc:title");}}]};v={title:"Music Menu",menu:[{title:"Music Library",menu:[{title:"Artists",menu:true,id:"A:ALBUMARTIST"},{title:"Albums",menu:true,id:"A:ALBUM"},{title:"Composers",menu:true,id:"A:COMPOSER"},{title:"Genres",menu:true,id:"A:GENRE"},{title:"Tracks",menu:true,id:"A:TRACKS"},{title:"Imported Playlists",menu:true,id:"A:PLAYLISTS"},o,{title:"Folders",menu:true,id:"S:"}]},{title:"Sonos Playlists",menu:true,id:"SQ:"},{title:"Radio",menu:true,id:"R:"},{title:"Line-in",menu:true,id:"AI:"},{title:"System Settings",menu:[{title:"Music Library Management",menu:[{title:"Update Music Index Now",action:function(){UPNPTEST.myHost.cdProxy.refreshshareindex(false,null);}}]}]}]};function w(){DISPATCH.setResponseWidget(GUI.widget("RESPONSE"));p=GUI.widget("TRANSPORT_STATE");MENUTEST.titleLabel=GUI.widget("PAGE_TITLE");}function g(){var A;UPNPTEST.browser.cancel();A=c.pop();if(A){s=A;MENUTEST.titleLabel.label=s.title;j.setItems(s,true);}}function x(A){DISPATCH.reportOk();c.push(s);s=A;MENUTEST.titleLabel.label=s.title;j.setItems(s);}function y(B,D,C){var A;A={};A.title=D;A.menu=[];j.emptyLabel="Searching...";x(A);UPNPTEST.browser.search(B,D,C);}function t(A){UPNPTEST.browser.cancel();if(A.action){A.action();}else{if(A.menu){if(A.menu===true){if(A.id){UPNPTEST.browser.browse(A.id,A.title);}}else{x(A);}}else{if(A.res){if(A.res.substring(0,16)==="x-rincon-stream:"){UPNPTEST.myHost.avtProxy.setavtransporturi(0,A.res,"");}else{if(A.res.substring(0,18)==="x-rincon-mp3radio:"){UPNPTEST.myHost.avtProxy.setavtransporturi(0,A.res,"");}}}}}}function f(A){if(A.res){u.label="Add to Queue";}else{u.label="";}}function b(C,A,D){var B;if((D===0)&&(!A.filter)){B={};B.title=A.title;B.menu=C;j.emptyLabel="No selections are available.";x(B);}else{if((A.done)&&(A.filter)){j.emptyLabel="No matches found.";}s.menu=s.menu.concat(C);j.setItems(s,true);}}function d(A){var B;switch(A.tag){case"PS_BACK":j.back();break;default:break;}}function z(A,B){MENUTEST.hardKeyPress.call(this.that,this);}function h(){var A;A=j.getCurrentItem();if(A){UPNPTEST.myHost.avtProxy.adduritoqueue(0,A.res,"",0,false);}}function e(){GUI.widget("PS_FIRM2").label="Zones";if(UPNPTEST.myHost){GUI.widget("PS_FIRM4").label="Now Playing";GUI.widget("PS_FIRM5").label="View Queue";}["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5"].forEach(function(A){var B;B=GUI.widget(A);B.setColor(COLORS.white,0);B.setColor(COLORS.white,1);B.fontSize=13;});GUI.widget("PS_FIRM2").onPress=function(){UPNPTEST.jump("ZONEMENU");};u=GUI.widget("PS_FIRM3");u.onPress=function(){MENUTEST.addToPlaylist();};GUI.widget("PS_FIRM4").onPress=function(){UPNPTEST.jump("NOWPLAYING");};GUI.widget("PS_FIRM5").onPress=function(){UPNPTEST.jump("QUEUE");};}function n(){["PS_BACK"].forEach(function(A){var B;try{B=GUI.widget(A);B.onPress=z;}catch(C){}});}function i(){if(c===undefined){c=[];s=v;}}function r(){var A=UPNPTEST.action;switch(A.operation){case"SEARCHJUMP":x(o);break;case"SEARCH":y(A.container,"Search Result",A.text);break;default:break;}delete UPNPTEST.action;}function q(B){var A="";switch(B){case"PLAYING":A="\uF087";break;case"STOPPED":A="\uF086";break;case"PAUSED_PLAYBACK":A="\uF085";break;case"TRANSITIONING":A="\uF0C1";break;case"PAUSED_RECORDING":A="\uF085\uF0A9";break;case"RECORDING":A="\uF0A9";break;case"NO_MEDIA_PRESENT":A="\uF0AB";break;default:break;}p.label=A;}function k(){e();w();if(UPNPTEST.myHost){i();j=new com.philips.Widgets.ListBox();j.init();j.onItem=t;j.onSelect=f;j.onBack=g;j.attachCursorPad();n();j.setItems(s);MENUTEST.titleLabel.label=s.title;UPNPTEST.browser.cancel();UPNPTEST.browser.onBrowseResult=b;if(UPNPTEST.myHost.avtProxy){UPNPTEST.myHost.avtProxy.onTransportStateChange=q;q(UPNPTEST.myHost.avtProxy.getTransportState(0));}if(UPNPTEST.action){r();}}else{GUI.alert("No zone selected.");}}function a(){DISPATCH.pageExit();UPNPTEST.browser.cancel();UPNPTEST.browser.onBrowseResult=undefined;if(UPNPTEST.myHost){if(UPNPTEST.myHost.avtProxy){UPNPTEST.myHost.avtProxy.onTransportStateChange=undefined;}}j.detachCursorPad();j=undefined;["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5","PS_BACK"].forEach(function(A){var B;B=GUI.widget(A);B.onPress=null;B.onHold=null;});}MENUTEST.pageEntry=k;MENUTEST.pageExit=a;MENUTEST.hardKeyPress=d;MENUTEST.addToPlaylist=h;CF.activity().page("MUSICMENU").onEntry=function(){MENUTEST.pageEntry();};CF.activity().page("MUSICMENU").onExit=function(){MENUTEST.pageExit();};}());/*
  %full_name: leu07hc1#1/ascii/page-NOWPLAYING.js/32 %
  %created_by: ycl %
  %version: 32 %
  %date_created: Wed Dec  9 17:47:32 2009 %
*/
var NOWPLAYING={};(function(){var k,e,b,g;function h(s){var r=e,o,p,m,q,n,l,t;m=196-8-8;if(s){o=s.width;p=s.height;if(o>p){l=m;t=(m*p)/o;}else{t=m;l=(m*o)/p;}r.x=10+((280-10-10-196)/2)+8+((1+m-l)/2);r.y=130+8+((1+m-t)/2);r.width=l;r.height=t;r.stretchImage=true;r.setImage(s);}else{r.x=10+((280-10-10-196)/2)+8;r.y=130+8;r.width=m;r.height=m;r.setImage(null);}}function f(o,l){var n,m;if(!o){return;}if(l===undefined){o.label="";return;}if(o.origLabel===l){return;}m=com.philips.Util.decodeUTF8(l);o.origLabel=l;o.label=m;}function d(){function q(t){var r,s,u;if(t>=0){s=Math.floor(t/60);u=Math.floor(t)%60;r=((s<10)?"0"+s:s)+":"+((u<10)?"0"+u:u);}return r;}var o,n=0,m,l,p;if(!b){return;}if(b.current){n=b.current;if((!b.dirty)&&(b.transportState==="PLAYING")){n+=(((new Date()).getTime())-b.time)/1000;if(n>b.duration){n=b.duration;}}}o=NOWPLAYING.progressBar;if(o){m=Math.round(o.origWidth*n/b.duration);if(m>o.origWidth){m=o.origWidth;}if(m>0){o.width=m;o.visible=true;}else{o.visible=false;}}if(NOWPLAYING.widgets){l=NOWPLAYING.widgets.AVT_PROGRESSTEXT;if(l){if(b.duration){p=q(n)+"/"+q(b.duration);}else{p="";}l.label=p;}}}function a(l){var m;m=NOWPLAYING.widgets;if(k!==l.albumArtURI){k=undefined;h(null);if(l.albumArtURI){ARTCACHE.fetch(l.albumArtURI);}}if(m){f(m.AVT_TRACK_TITLE,l.title);f(m.AVT_ARTIST_NAME,l.artist);f(m.AVT_ALBUM_NAME,l.album);}d();}function j(){d();}function c(){var m=com.philips.Util.printLine,t,q,s,x,n;function o(w,z){if(z!==k){h(w);k=z;}}function p(w){b=w;}function y(A){var w=NOWPLAYING.widgets.SHUFFLE,z=NOWPLAYING.widgets.REPEAT;if(!A){w.visible=false;z.visiable=false;return;}switch(A){case"NORMAL":w.visible=false;z.visible=false;break;case"REPEAT_ALL":w.visible=false;z.visible=true;break;case"SHUFFLE_NOREPEAT":w.visible=true;z.visible=false;break;case"SHUFFLE":w.visible=true;z.visible=true;break;default:x.label=A;break;}}NOWPLAYING.changePlayMode=function(){var w,z;w=UPNPTEST.myHost.avtProxy.getPlayMode(0);switch(w){case"NORMAL":z="SHUFFLE_NOREPEAT";break;case"SHUFFLE_NOREPEAT":z="REPEAT_ALL";break;case"REPEAT_ALL":z="SHUFFLE";break;case"SHUFFLE":z="NORMAL";break;default:z="NORMAL";break;}UPNPTEST.myHost.avtProxy.setPlayMode(0,z);y(z);};function l(z){var w="";switch(z){case"PLAYING":w="\uF087";break;case"STOPPED":w="\uF086";break;case"PAUSED_PLAYBACK":w="\uF085";break;case"TRANSITIONING":w="\uF0C1";break;case"PAUSED_RECORDING":w="\uF085\uF0A9";break;case"RECORDING":w="\uF0A9";break;case"NO_MEDIA_PRESENT":w="\uF0AB";break;default:break;}n.label=w;}function r(){GUI.widget("PS_FIRM2").label="Zones";if(UPNPTEST.myHost){GUI.widget("PS_FIRM1").label="Play Mode";GUI.widget("PS_FIRM4").label="Music";GUI.widget("PS_FIRM5").label="View Queue";}["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5"].forEach(function(z){var A;A=GUI.widget(z);A.setColor(COLORS.white,0);A.setColor(COLORS.white,1);A.fontSize=13;A.onPress=null;});GUI.widget("PS_FIRM1").onPress=function(){NOWPLAYING.changePlayMode();};GUI.widget("PS_FIRM2").onPress=function(){UPNPTEST.jump("ZONEMENU");};GUI.widget("PS_FIRM4").onPress=function(){UPNPTEST.jump("MUSICMENU");};GUI.widget("PS_FIRM5").onPress=function(){UPNPTEST.jump("QUEUE");};GUI.widget("PS_OK").onPress=function(){};GUI.widget("PS_BACK").onPress=function(){UPNPTEST.jump("MUSICMENU");};}function v(){var z;DISPATCH.setResponseWidget(GUI.widget("RESPONSE"));NOWPLAYING.widgets=[];n=GUI.widget("TRANSPORT_STATE");e=GUI.widget("COVERART");NOWPLAYING.widgets.AVT_TRACK_TITLE=GUI.widget("TRACK_TITLE");NOWPLAYING.widgets.AVT_PROGRESSTEXT=GUI.widget("PROGRESS_TEXT");NOWPLAYING.widgets.AVT_ARTIST_NAME=GUI.widget("ARTIST_NAME");NOWPLAYING.widgets.AVT_ALBUM_NAME=GUI.widget("ALBUM_TITLE");z=GUI.widget("PREVIOUS");z.onPress=function(w,A){UPNPTEST.myHost.avtProxy.previous(0);};z=GUI.widget("PAUSE");z.onPress=function(w,A){UPNPTEST.myHost.avtProxy.pause(0);};z=GUI.widget("PLAY");z.onPress=function(w,A){UPNPTEST.myHost.avtProxy.play(0,1);};z=GUI.widget("STOP");z.onPress=function(w,A){UPNPTEST.myHost.avtProxy.stop(0);};z=GUI.widget("NEXT");z.onPress=function(w,A){UPNPTEST.myHost.avtProxy.next(0);};z=GUI.widget("PROGRESSBAR");z.origWidth=z.width;z.width=1;z.visible=false;NOWPLAYING.progressBar=z;z=GUI.widget("SHUFFLE");z.visible=false;NOWPLAYING.widgets.SHUFFLE=z;z=GUI.widget("REPEAT");z.visible=false;NOWPLAYING.widgets.REPEAT=z;}function u(){var z,w;w=UPNPTEST.myHost;if((w)&&(w.avtProxy)){z=w.avtProxy.getTrackInfo(0);if(z){a(z);}b=w.avtProxy.getPosition(0);d();}}r();if(UPNPTEST.myHost){v();ARTCACHE.onArt=o;u();DISPATCH.addTicker(j);if(UPNPTEST.myHost.avtProxy){UPNPTEST.myHost.avtProxy.onPosition=p;UPNPTEST.myHost.avtProxy.onTrackInfo=a;UPNPTEST.myHost.avtProxy.onTransportStateChange=l;l(UPNPTEST.myHost.avtProxy.getTransportState(0));UPNPTEST.myHost.avtProxy.onPlayModeChange=y;y(UPNPTEST.myHost.avtProxy.getPlayMode(0));}UPNPTEST.minimal=false;}else{GUI.alert("No zone selected.");}}function i(){DISPATCH.removeTicker(d);DISPATCH.pageExit();ARTCACHE.onArt=undefined;UPNPTEST.minimal=true;NOWPLAYING.widgets.AVT_TRACK_TITLE.origLabel=undefined;NOWPLAYING.widgets.AVT_ARTIST_NAME.origLabel=undefined;NOWPLAYING.widgets.AVT_ALBUM_NAME.origLabel=undefined;if((UPNPTEST.myHost)&&(UPNPTEST.myHost.avtProxy)){UPNPTEST.myHost.avtProxy.onPosition=undefined;UPNPTEST.myHost.avtProxy.onTrackInfo=undefined;UPNPTEST.myHost.avtProxy.onTransportStateChange=undefined;UPNPTEST.myHost.avtProxy.onPlayModeChange=undefined;}["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5","PS_OK","PS_BACK"].forEach(function(l){var m;m=GUI.widget(l);m.onPress=null;});k=undefined;e=undefined;b=undefined;}NOWPLAYING.pageEntry=c;NOWPLAYING.pageExit=i;CF.activity().page("NOWPLAYING").onEntry=function(){NOWPLAYING.pageEntry();};CF.activity().page("NOWPLAYING").onExit=function(){NOWPLAYING.pageExit();};}());/*
  %full_name: leu07hc1#1/ascii/page-ZONEMENU.js/16 %
  %created_by: ycl %
  %version: 16 %
  %date_created: Wed Dec  9 17:47:34 2009 %
*/
var ZONEMENU={};(function(){var e,b;function d(f){DISPATCH.reportOk();UPNPTEST.myHost=f.upnpHost;UPNPTEST.browser.cdProxy=f.upnpHost.cdProxy;UPNPTEST.jump("NOWPLAYING");}ZONEMENU.add=function(f){b.menu.push(f);if(e){e.setItems(b);}};function c(){function g(){if(UPNPTEST.myHost){GUI.widget("PS_FIRM3").label="Now Playing";GUI.widget("PS_FIRM4").label="Music";}["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5"].forEach(function(h){var i;i=GUI.widget(h);i.setColor(COLORS.white,0);i.setColor(COLORS.white,1);i.fontSize=13;i.onPress=null;});GUI.widget("PS_FIRM3").onPress=function(){UPNPTEST.jump("NOWPLAYING");};GUI.widget("PS_FIRM4").onPress=function(){UPNPTEST.jump("MUSICMENU");};}function f(){e=new com.philips.Widgets.ListBox();e.init();e.setItems(b);e.onItem=d;e.emptyLabel="Searching for ZonePlayers and ZoneBridges...";e.attachCursorPad();}DISPATCH.setResponseWidget(GUI.widget("RESPONSE"));g();f();UPNPTEST.discoverTimer.start();}function a(){DISPATCH.pageExit();e.detachCursorPad();e=undefined;UPNPTEST.discoverTimer.stop();["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5"].forEach(function(f){var g;try{g=GUI.widget(f);g.onPress=null;g.label=null;}catch(h){}});}ZONEMENU.pageEntry=c;ZONEMENU.pageExit=a;CF.activity().page("ZONEMENU").onEntry=function(){ZONEMENU.pageEntry();};CF.activity().page("ZONEMENU").onExit=function(){ZONEMENU.pageExit();};b={menu:[]};}());/*
  %full_name: leu07hc1#1/ascii/page-QUEUE.js/24 %
  %created_by: ycl %
  %version: 24 %
  %date_created: Wed Dec  9 17:47:33 2009 %
*/
var QUEUEMENU={};(function(){var k,r,u,m,g;function q(y){}u={menu:[]};function v(){m=GUI.widget("TRANSPORT_STATE");}function w(y){r=y;g.setItems(r);}function t(A){var z,y,B=0;B=parseInt(A.id.substring(4),10);y="x-rincon-queue:"+UPNPTEST.myHost.UDN.substring(5)+"#0";z=UPNPTEST.myHost.avtProxy.getAVTransportURI();if(z!==y){UPNPTEST.myHost.avtProxy.setavtransporturi(0,y,"");}UPNPTEST.myHost.avtProxy.seek(0,"TRACK_NR",B);}function b(A,y,B){var z;if(B===0){z={};z.title="Queue";if(A.length>0){GUI.widget("PS_FIRM1").label="Remove";GUI.widget("PS_FIRM3").label="Clear Queue";}z.menu=A;w(z);}else{r.menu=r.menu.concat(A);g.setItems(r,true);}}function s(){UPNPTEST.jump("MUSICMENU");}function j(){UPNPTEST.browser.browse("Q:0",undefined);}function i(){UPNPTEST.jump("MUSICMENU");}function c(y){var z;switch(y.tag){case"PS_BACK":i();break;default:break;}}function x(z,A){QUEUEMENU.hardKeyPress.call(this.that,this);}function d(){UPNPTEST.myHost.avtProxy.removealltracksfromqueue(0);}function p(){var z,y;z=g.getCurrentItem();if(z){y=z.id;if(y){UPNPTEST.myHost.avtProxy.removetrackfromqueue(0,y);}}}function f(y){var z;z=GUI.widget("PS_FIRM1");if(y.id){z.label="Remove";}else{z.label="";}}function e(){GUI.widget("PS_FIRM2").label="Zones";if(UPNPTEST.myHost){GUI.widget("PS_FIRM4").label="Now Playing";GUI.widget("PS_FIRM5").label="Music";}["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5"].forEach(function(y){var z;z=GUI.widget(y);z.setColor(COLORS.white,0);z.setColor(COLORS.white,1);z.fontSize=13;});GUI.widget("PS_FIRM1").onPress=function(){QUEUEMENU.removeTrack();};GUI.widget("PS_FIRM2").onPress=function(){UPNPTEST.jump("ZONEMENU");};GUI.widget("PS_FIRM3").onPress=function(){QUEUEMENU.clearQueue();};GUI.widget("PS_FIRM4").onPress=function(){UPNPTEST.jump("NOWPLAYING");};GUI.widget("PS_FIRM5").onPress=function(){UPNPTEST.jump("MUSICMENU");};}function l(){["PS_BACK"].forEach(function(y){var z;try{z=GUI.widget(y);z.onPress=x;}catch(A){}});}function o(){}function n(z){var y="";switch(z){case"PLAYING":y="\uF087";break;case"STOPPED":y="\uF086";break;case"PAUSED_PLAYBACK":y="\uF085";break;case"TRANSITIONING":y="\uF0C1";break;case"PAUSED_RECORDING":y="\uF085\uF0A9";break;case"RECORDING":y="\uF0A9";break;case"NO_MEDIA_PRESENT":y="\uF0AB";break;default:break;}m.label=y;}function h(){e();DISPATCH.reportOk();DISPATCH.setResponseWidget(GUI.widget("RESPONSE"));if(UPNPTEST.myHost){v();g=new com.philips.Widgets.ListBox();g.init();g.onSelect=f;g.onItem=t;g.onBack=i;g.attachCursorPad();l();r=u;g.emptyLabel="The Queue is empty.";UPNPTEST.browser.onBrowseResult=b;UPNPTEST.browser.browse("Q:0",undefined);if(UPNPTEST.myHost.avtProxy){UPNPTEST.myHost.avtProxy.onQueueCleared=s;UPNPTEST.myHost.avtProxy.onQueueChanged=j;UPNPTEST.myHost.avtProxy.onTransportStateChange=n;n(UPNPTEST.myHost.avtProxy.getTransportState(0));}if(UPNPTEST.keyboardAction){o();}}else{GUI.alert("No zone selected.");}}function a(){DISPATCH.pageExit();UPNPTEST.browser.onBrowseResult=undefined;if(UPNPTEST.myHost){if(UPNPTEST.myHost.cdProxy){}if(UPNPTEST.myHost.avtProxy){UPNPTEST.myHost.avtProxy.onQueueCleared=undefined;UPNPTEST.myHost.avtProxy.onQueueChanged=undefined;UPNPTEST.myHost.avtProxy.onTransportStateChange=undefined;}}g.detachCursorPad();g=undefined;["PS_FIRM1","PS_FIRM2","PS_FIRM3","PS_FIRM4","PS_FIRM5","PS_OK","PS_CURSOR_UP","PS_CURSOR_DOWN","PS_CURSOR_RIGHT","PS_CURSOR_LEFT","PS_BACK"].forEach(function(y){var z;z=GUI.widget(y);z.onPress=null;z.onHold=null;});}QUEUEMENU.pageEntry=h;QUEUEMENU.pageExit=a;QUEUEMENU.hardKeyPress=c;QUEUEMENU.clearQueue=d;QUEUEMENU.removeTrack=p;CF.activity().page("QUEUE").onEntry=function(){QUEUEMENU.pageEntry();};CF.activity().page("QUEUE").onExit=function(){QUEUEMENU.pageExit();};}());/*
  %full_name: leu07hc1#1/ascii/demo.upnp-sonos.js/21 %
  %created_by: ycl %
  %version: 21 %
  %date_created: Wed Dec  9 17:47:27 2009 %
*/
var UPNPTEST={};(function(){var c,i;function d(p){if(NOWPLAYING.onTrackInfo){NOWPLAYING.onTrackInfo(p);}}function e(p){if(NOWPLAYING.onPosition){NOWPLAYING.onPosition(p);}}function h(s){var q,r,p=false;if(s.manufacturer==="Sonos, Inc."){r=s.modelNumber+" "+s.friendlyName;q={};q.upnpHost=s;q.title=r;UPNPTEST.host.push(q);ZONEMENU.add(q);p=true;}return p;}function b(){c.search();}function k(){if(!UPNPTEST.minimal){UPNPTEST.myHost.avtProxy.updateCurrent();}UPNPTEST.queue.schedule();}function o(){var p=com.philips.UPnP,r,q;if((UPNPTEST.myHost)&&(UPNPTEST.myHost.avtProxy)){UPNPTEST.myHost.avtProxy.refresh();}if((UPNPTEST.myHost)&&(UPNPTEST.myHost.rcProxy)){UPNPTEST.myHost.rcProxy.refresh();}}function m(){var p,q;q={};p=CF.page("JUMPS");q.ZONEMENU=p.widget("B_JUMP_ZONEMENU");q.MUSICMENU=p.widget("B_JUMP_MUSICMENU");q.KEYBOARD=p.widget("B_JUMP_KEYBOARD");q.NOWPLAYING=p.widget("B_JUMP_NOWPLAYING");q.QUEUE=p.widget("B_JUMP_QUEUE");i=q;}function n(){VOLUME.toggleMute();}function a(){VOLUME.up();}function g(){VOLUME.down();}function l(){var p;p=CF.widget("PS_MUTE");p.onPress=n;p=CF.widget("PS_VOLUME_UP");p.onPress=a;p.onHold=a;p.onHoldInterval=100;p=CF.widget("PS_VOLUME_DOWN");p.onPress=g;p.onHold=g;p.onHoldInterval=100;CF.widget("PS_PAGE_UP").onPress=function(){};CF.widget("PS_PAGE_DOWN").onPress=function(){};CF.widget("PS_GUIDE").onPress=function(){if(UPNPTEST.myHost){UPNPTEST.action={};UPNPTEST.action.operation="SEARCHJUMP";UPNPTEST.jump("MUSICMENU");}};}function f(){var p;p=new com.philips.Util.PeriodicTimer();p.setInterval(2000);p.setCallback(b);UPNPTEST.discoverTimer=p;p=new com.philips.Util.PeriodicTimer();p.setInterval(3000);p.setCallback(k);p.start();p=new com.philips.Util.PeriodicTimer();p.setInterval(2*60*1000);p.setCallback(o);p.start();UPNPTEST.updateTimer=p;}UPNPTEST.jump=function(q){var p;p=i[q];if(p){p.scheduleActions();}};UPNPTEST.host=[];UPNPTEST.queue=new com.philips.Util.BatchQueue();UPNPTEST.minimal=true;UPNPTEST.discover=true;UPNPTEST.browser=new com.philips.UPnP.Browser();m();f();l();LISTENER.init();c=new com.philips.SSDP.SSDPClient();c.onAdded=function(p){com.philips.UPnP.detectServer(p.location,undefined,UPNPTEST.queue);};c.start();com.philips.UPnP.onNewHost=h;function j(s,w){var u,t,q,v,p=com.philips.HttpLibrary.parseHttpUri;if(w.substring(0,7)==="http://"){u=p(w);t=u.host;q=u.port;v=u.relRequestURI+u.fragment;}else{u=p(s);t=u.host;q=u.port;v=w;}}}());